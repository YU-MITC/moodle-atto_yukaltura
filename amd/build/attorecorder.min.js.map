{"version":3,"sources":["../src/attorecorder.js"],"names":["define","$","init","fileSize","sizeResult","fileType","uploadFileType","naturalWidth","naturalHeight","defaultWidth","defaultHeight","localStream","videoBlob","videoFilename","blobUrl","recorder","constraints","createObjectURL","window","URL","file","webkitURL","revokeObjectURL","MEDIA_TYPE","VIDEO","IMAGE","AUDIO","AUTO_FINALIZE","TRUE","FALSE","NULL","ENTRY_STATUS","ENTRY_IMPORTING","ENTRY_CONVERTING","ENTRY_IMPORT","ENTRY_PRECONVERT","ENTRY_READY","ENTRY_DELETED","ENTRY_PENDING","ENTRY_MODERATE","ENTRY_BLOCKED","ENTRY_NO_CONTENT","UPLOAD_TOKEN_STATUS","PENDING","PARTIAL_UPLOAD","FULL_UPLOAD","CLOSED","TIMED_OUT","DELETED","isIE","ua","navigator","userAgent","toLowerCase","ver","appVersion","isMsIE","indexOf","isIE6","isIE7","isIE8","isIE9","isIE10","isIE11","isEdge","isMsEdge","isChrome","isFirefox","isSafari","isOpera","checkUnsupportedBrowser","browser","require","str","message","get_string","when","done","localizedString","printInitialErrorMessage","disableInsertButton","enableCancelButton","getOperatingSystem","os","match","checkUnsupportedOS","isHttps","location","protocol","html","setPlayingPlayer","url","document","getElementById","pause","currentTime","setPreviewPlayer","attr","startRecording","val","off","on","stopRecording","css","volume","start","ondataavailable","evt","Blob","data","type","size","sizeStr","dividedSize","toFixed","checkFileType","checkFileSize","alert","checkForm","getFileExtension","getTracks","tracks","i","length","stop","srcObject","removeVideo","mediaDevices","mozGetUserMedia","webkitGetUserMedia","getUserMedia","c","y","n","call","MediaRecorder","err","console","log","mimeOption","WebcamRecorder","MediaSource","isTypeSupported","audioBitsPerSecond","videoBitsPerSecond","mimeType","audio","echoCancellation","video","minWidth","minHeight","maxWidth","maxHeight","minFrameRate","maxFrameRate","p","then","stream","play","catch","prop","printErrorMessage","errorMessage","append","printSuccessMessage","id","name","tags","description","creatorId","notification","get_strings","key","component","results","output","fail","exception","enableInsertButton","handleResetClick","checkNameString","test","checkTagsString","checkMetadata","nameStr","tagsStr","descStr","flag","handleSubmitClick","executeUploadProcess","getHiddenParameters","parent","element","kalturahost","partnerid","uiconfid","width","height","studio","updateHiddenParameters","opacity","disableCancelButton","serverHost","ks","createUploadToken","deleteUploadToken","uploadTokenId","fd","FormData","ajax","cache","contentType","scriptCharset","processData","async","dataType","xmlData","dir","findData","serviceURL","encodeURI","find","text","uploadTokenStatus","setTimeout","createMediaEntry","entryStatus","entryId","entryName","entryTags","entryDescription","entryCreatorId","controlId","trim","uploadMediaFile","xhr","XHR","ajaxSettings","upload","addEventListener","e","newValue","parseInt","loaded","total","attachUploadedFile","IMPORT","IMPORTING","sessionEnd","remove"],"mappings":"mSA2BAA,OAAM,+BAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAE3B,MAAO,CAKHC,IAAI,CAAE,eAAW,IAETC,CAAAA,CAAQ,CAAG,CAFF,CAGTC,CAAU,GAHD,CAITC,CAAQ,CAAG,EAJF,CAMTC,CAAc,CAAG,EANR,CAOTC,CAAY,CAAG,CAPN,CAQTC,CAAa,CAAG,CARP,CAUTC,CAAY,CAAG,GAVN,CAWTC,CAAa,CAAG,GAXP,CAaTC,CAAW,CAAG,IAbL,CAcTC,CAAS,CAAG,IAdH,CAeTC,CAAa,CAAG,EAfP,CAgBTC,CAAO,CAAG,IAhBD,CAiBTC,CAAQ,CAAG,IAjBF,CAkBTC,CAAW,CAAG,IAlBL,CAoBTC,CAAe,CAAGC,MAAM,CAACC,GAAP,EAAcD,MAAM,CAACC,GAAP,CAAWF,eAAzB,CACZ,SAASG,CAAT,CAAe,CACb,MAAOF,CAAAA,MAAM,CAACC,GAAP,CAAWF,eAAX,CAA2BG,CAA3B,CACV,CAHa,CAIZF,MAAM,CAACG,SAAP,EAAoBH,MAAM,CAACG,SAAP,CAAiBJ,eAArC,CACI,SAASG,CAAT,CAAe,CACb,MAAOF,CAAAA,MAAM,CAACG,SAAP,CAAiBJ,eAAjB,CAAiCG,CAAjC,CACV,CAHH,OAxBG,CA8BTE,CAAe,CAAGJ,MAAM,CAACC,GAAP,EAAcD,MAAM,CAACC,GAAP,CAAWG,eAAzB,CACZ,SAASF,CAAT,CAAe,CACb,MAAOF,CAAAA,MAAM,CAACC,GAAP,CAAWG,eAAX,CAA2BF,CAA3B,CACV,CAHa,CAIZF,MAAM,CAACG,SAAP,EAAoBH,MAAM,CAACG,SAAP,CAAiBC,eAArC,CACI,SAASF,CAAT,CAAe,CACb,MAAOF,CAAAA,MAAM,CAACG,SAAP,CAAiBC,eAAjB,CAAiCF,CAAjC,CACV,CAHH,OAlCG,CAwCTG,EAAU,CAAG,CACbC,KAAK,CAAE,CADM,CAEbC,KAAK,CAAE,CAFM,CAGbC,KAAK,CAAE,CAHM,CAxCJ,CA8CTC,EAAa,CAAG,CAChBC,IAAI,CAAE,CADU,CAEhBC,KAAK,CAAE,CAFS,CAGhBC,IAAI,CAAE,CAAC,CAHS,CA9CP,CAoDTC,EAAY,CAAG,CACfC,eAAe,CAAE,CAAC,CADH,CAEfC,gBAAgB,CAAE,CAAC,CAFJ,CAGfC,YAAY,CAAE,CAHC,CAIfC,gBAAgB,CAAE,CAJH,CAKfC,WAAW,CAAE,CALE,CAMfC,aAAa,CAAE,CANA,CAOfC,aAAa,CAAE,CAPA,CAQfC,cAAc,CAAE,CARD,CASfC,aAAa,CAAE,CATA,CAUfC,gBAAgB,CAAE,CAVH,CApDN,CAiETC,EAAmB,CAAG,CACtBC,OAAO,CAAE,CADa,CAEtBC,cAAc,CAAE,CAFM,CAGtBC,WAAW,CAAE,CAHS,CAItBC,MAAM,CAAE,CAJc,CAKtBC,SAAS,CAAE,CALW,CAMtBC,OAAO,CAAE,CANa,CAjEb,CA+Eb,QAASC,CAAAA,CAAT,EAAgB,IACRC,CAAAA,CAAE,CAAGC,SAAS,CAACC,SAAV,CAAoBC,WAApB,EADG,CAERC,CAAG,CAAGH,SAAS,CAACI,UAAV,CAAqBF,WAArB,EAFE,CAKRG,CAAM,CAAyB,CAAC,CAAtB,CAAAN,CAAE,CAACO,OAAH,CAAW,MAAX,CAAD,EAAqD,CAAC,CAAxB,EAAAP,CAAE,CAACO,OAAH,CAAW,OAAX,CAL/B,CAORC,CAAK,CAAGF,CAAM,EAA8B,CAAC,CAA1B,CAAAF,CAAG,CAACG,OAAJ,CAAY,SAAZ,CAPX,CASRE,CAAK,CAAGH,CAAM,EAA8B,CAAC,CAA1B,CAAAF,CAAG,CAACG,OAAJ,CAAY,SAAZ,CATX,CAWRG,CAAK,CAAGJ,CAAM,EAA8B,CAAC,CAA1B,CAAAF,CAAG,CAACG,OAAJ,CAAY,SAAZ,CAXX,CAaRI,CAAK,CAAGL,CAAM,EAA8B,CAAC,CAA1B,CAAAF,CAAG,CAACG,OAAJ,CAAY,SAAZ,CAbX,CAeRK,CAAM,CAAGN,CAAM,EAA+B,CAAC,CAA3B,CAAAF,CAAG,CAACG,OAAJ,CAAY,UAAZ,CAfZ,CAiBRM,CAAM,CAA8B,CAAC,CAA3B,CAAAb,CAAE,CAACO,OAAH,CAAW,WAAX,CAjBF,CAmBZ,MAAOD,CAAAA,CAAM,EAAIE,CAAV,EAAmBC,CAAnB,EAA4BC,CAA5B,EAAqCC,CAArC,EAA8CC,CAA9C,EAAwDC,CAClE,CAOD,QAASC,CAAAA,CAAT,EAAkB,IACVd,CAAAA,CAAE,CAAGC,SAAS,CAACC,SAAV,CAAoBC,WAApB,EADK,CAIVY,CAAQ,CAAyB,CAAC,CAAtB,CAAAf,CAAE,CAACO,OAAH,CAAW,MAAX,CAJF,CAMVS,CAAQ,CAA2B,CAAC,CAAxB,CAAAhB,CAAE,CAACO,OAAH,CAAW,QAAX,CAAD,EAAsD,CAAC,CAAvB,EAAAP,CAAE,CAACO,OAAH,CAAW,MAAX,CANjC,CAQVU,CAAS,CAA4B,CAAC,CAAzB,CAAAjB,CAAE,CAACO,OAAH,CAAW,SAAX,CARH,CAUVW,CAAQ,CAA2B,CAAC,CAAxB,CAAAlB,CAAE,CAACO,OAAH,CAAW,QAAX,CAAD,EAAwD,CAAC,CAAzB,EAAAP,CAAE,CAACO,OAAH,CAAW,QAAX,CAVjC,CAYVY,CAAO,CAA0B,CAAC,CAAvB,CAAAnB,CAAE,CAACO,OAAH,CAAW,OAAX,CAZD,CAcd,MAAO,KAAAQ,CAAQ,EAAa,KAAAC,CAArB,EAA2C,KAAAC,CAA3C,EAAkE,KAAAC,CAAlE,EAAwF,KAAAC,CAClG,CAOD,QAASC,CAAAA,CAAT,EAAmC,CAE/B,GAAIrB,CAAI,IAAMe,CAAM,EAApB,CAAwB,CACpB,GAAIO,CAAAA,CAAO,CAAG,EAAd,CACA,GAAItB,CAAI,EAAR,CAAY,CACRsB,CAAO,CAAG,mBACb,CAFD,IAEO,CACHA,CAAO,CAAG,MACb,CAEDC,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,qBAAf,CAAsC,iBAAtC,CAAyDJ,CAAzD,CAAd,CACAtE,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3CC,CAAwB,CAACD,CAAD,CAC3B,CAFD,CAGH,CALM,CAAP,CAOAE,CAAmB,GACnBC,CAAkB,GAElB,QACH,CACD,QACH,CAMD,QAASC,CAAAA,CAAT,EAA8B,IACtBC,CAAAA,CADsB,CAEtBjC,CAAE,CAAGC,SAAS,CAACC,SAFO,CAI1B,GAAIF,CAAE,CAACkC,KAAH,CAAS,kBAAT,CAAJ,CAAkC,CAC9BD,CAAE,CAAG,KACR,CAFD,IAEO,IAAIjC,CAAE,CAACkC,KAAH,CAAS,iBAAT,CAAJ,CAAiC,CACpCD,CAAE,CAAG,SACR,CAFM,IAEA,IAAIjC,CAAE,CAACkC,KAAH,CAAS,aAAT,CAAJ,CAA6B,CAChCD,CAAE,CAAG,OACR,CAFM,IAEA,IAAIjC,CAAE,CAACkC,KAAH,CAAS,WAAT,CAAJ,CAA2B,CAC9BD,CAAE,CAAG,SACR,CAFM,IAEA,IAAIjC,CAAE,CAACkC,KAAH,CAAS,SAAT,CAAJ,CAAyB,CAC5BD,CAAE,CAAG,QACR,CAFM,IAEA,IAAIjC,CAAE,CAACkC,KAAH,CAAS,MAAT,CAAJ,CAAsB,CACzBD,CAAE,CAAG,WACR,CAFM,IAEA,CACHA,CAAE,CAAG,OACR,CAED,MAAOA,CAAAA,CACV,CAOD,QAASE,CAAAA,CAAT,EAA8B,CAE1B,GAAIF,CAAAA,CAAE,CAAGD,CAAkB,EAA3B,CAEA,GAAU,KAAN,EAAAC,CAAE,EAAmB,SAAN,EAAAA,CAAnB,CAAoC,CAChCX,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,gBAAf,CAAiC,iBAAjC,CAAoDQ,CAApD,CAAd,CACAlF,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3CC,CAAwB,CAACD,CAAD,CAC3B,CAFD,CAGH,CALM,CAAP,CAOAE,CAAmB,GACnBC,CAAkB,GAElB,QACH,CACD,QACH,CAMD,QAASK,CAAAA,CAAT,EAAmB,CACf,GAAIb,CAAAA,CAAG,CAAGvD,MAAM,CAACqE,QAAP,CAAgBC,QAA1B,CACA,GAA4B,CAAC,CAAzB,EAAAf,CAAG,CAAChB,OAAJ,CAAY,OAAZ,CAAJ,CAAgC,CAC5B,QACH,CACD,QACH,CAOD,QAASsB,CAAAA,CAAT,CAAkCL,CAAlC,CAA2C,CACvC,GAAID,CAAAA,CAAG,CAAG,EAAV,CACAA,CAAG,CAAG,0BAA4BC,CAA5B,CAAsC,aAA5C,CACAzE,CAAC,CAAC,cAAD,CAAD,CAAkBwF,IAAlB,CAAuBhB,CAAvB,EAEAO,CAAmB,GACnBC,CAAkB,EACrB,CAOD,QAASS,CAAAA,CAAT,CAA0BC,CAA1B,CAA+B,CAC3B,GAAIlB,CAAAA,CAAG,CAAG,gCAAkChE,CAAlC,CAAiD,cAAjD,CAAkEC,CAAlE,CAAkF,KAA5F,CACA+D,CAAG,CAAGA,CAAG,CAAG,QAAN,CAAiBkB,CAAjB,CAAuB,yEAA7B,CACA1F,CAAC,CAAC,YAAD,CAAD,CAAgBwF,IAAhB,CAAqBhB,CAArB,EACAmB,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCC,KAAlC,GACAF,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCE,WAAlC,CAAgD,CACnD,CAOD,QAASC,CAAAA,CAAT,CAA0BL,CAA1B,CAA+B,CAC3B,GAAIlB,CAAAA,CAAG,CAAG,gCAAkChE,CAAlC,CAAiD,cAAjD,CAAkEC,CAAlE,CAAkF,KAA5F,CACA+D,CAAG,CAAGA,CAAG,CAAG,+DAAZ,CACAxE,CAAC,CAAC,YAAD,CAAD,CAAgBwF,IAAhB,CAAqBhB,CAArB,EACAxE,CAAC,CAAC,SAAD,CAAD,CAAagG,IAAb,CAAkB,KAAlB,CAAyBN,CAAzB,CACH,CAMD,QAASO,CAAAA,CAAT,EAA0B,CACtBjG,CAAC,CAAC,UAAD,CAAD,CAAcgG,IAAd,CAAmB,KAAnB,CAA0BhG,CAAC,CAAC,UAAD,CAAD,CAAckG,GAAd,EAA1B,EACAlG,CAAC,CAAC,UAAD,CAAD,CAAcmG,GAAd,CAAkB,OAAlB,EAEAnG,CAAC,CAAC,UAAD,CAAD,CAAcoG,EAAd,CAAiB,OAAjB,CAA0B,UAAW,CACjCC,CAAa,EAChB,CAFD,EAIArG,CAAC,CAAC,WAAD,CAAD,CAAesG,GAAf,CAAmB,SAAnB,CAA8B,QAA9B,EACAtG,CAAC,CAAC,SAAD,CAAD,CAAauG,MAAb,CAAsB,CAAtB,CACAzF,CAAQ,CAAC0F,KAAT,GAEAjC,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,eAAf,CAAgC,iBAAhC,CAAmD,IAAnD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C7E,CAAC,CAAC,SAAD,CAAD,CAAawF,IAAb,CAAkB,uBAAyBX,CAAzB,CAA2C,SAA7D,CACH,CAFD,CAGH,CALM,CAMV,CAMD,QAASwB,CAAAA,CAAT,EAAyB,CACrBvF,CAAQ,CAAC2F,eAAT,CAA2B,SAASC,CAAT,CAAc,CACrC/F,CAAS,CAAG,GAAIgG,CAAAA,IAAJ,CAAS,CAACD,CAAG,CAACE,IAAL,CAAT,CAAqB,CAACC,IAAI,CAAEH,CAAG,CAACE,IAAJ,CAASC,IAAhB,CAArB,CAAZ,CACA,GAAI5F,MAAM,CAACC,GAAP,EAAcD,MAAM,CAACC,GAAP,CAAWF,eAA7B,CAA8C,CAC1CH,CAAO,CAAGI,MAAM,CAACC,GAAP,CAAWF,eAAX,CAA2BL,CAA3B,CACb,CAFD,IAEO,CACHE,CAAO,CAAGI,MAAM,CAACG,SAAP,CAAiBJ,eAAjB,CAAiCL,CAAjC,CACb,CACD8E,CAAgB,CAAC5E,CAAD,CAAhB,CACAX,CAAQ,CAAGS,CAAS,CAACmG,IAArB,CARqC,GASjCC,CAAAA,CAAO,CAAG,EATuB,CAUjCC,CAAW,CAAG,CAVmB,CAYrC,GAAI9G,CAAQ,WAAZ,CAAmC,CAC/B8G,CAAW,CAAG9G,CAAQ,WAAtB,CACA6G,CAAO,CAAGC,CAAW,CAACC,OAAZ,CAAoB,CAApB,EAAyB,IACtC,CAHD,IAGO,IAAI/G,CAAQ,QAAZ,CAA4B,CAC/B8G,CAAW,CAAG9G,CAAQ,QAAtB,CACA6G,CAAO,CAAGC,CAAW,CAACC,OAAZ,CAAoB,CAApB,EAAyB,IACtC,CAHM,IAGA,IAAe,IAAX,CAAA/G,CAAJ,CAAqB,CACxB8G,CAAW,CAAG9G,CAAQ,CAAG,IAAzB,CACA6G,CAAO,CAAGC,CAAW,CAACC,OAAZ,CAAoB,CAApB,EAAyB,IACtC,CAHM,IAGA,CACHF,CAAO,CAAG7G,CAAQ,CAAG,GACxB,CAEDqE,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,eAAf,CAAgC,iBAAhC,CAAmD,IAAnD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3CA,CAAe,CAAG,yBAA2BA,CAA3B,CAA6C,GAA7C,CAAmDlE,CAAS,CAACkG,IAA7D,CAAoE,IAAtF,CACAhC,CAAe,CAAGA,CAAe,CAAGkC,CAAlB,CAA4B,YAA9C,CACA/G,CAAC,CAAC,SAAD,CAAD,CAAawF,IAAb,CAAkBX,CAAlB,CACH,CAJD,CAKH,CAPM,CAAP,CASAzE,CAAQ,CAAG8G,CAAa,CAACvG,CAAS,CAACkG,IAAX,CAAxB,CACA1G,CAAU,CAAGgH,CAAa,EAA1B,CACA,GAAI,KAAAhH,CAAJ,CAA0B,CACtBoE,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,gBAAf,CAAiC,iBAAjC,CAAoD,IAApD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C5D,MAAM,CAACmG,KAAP,CAAavC,CAAb,CACH,CAFD,CAGH,CALM,CAAP,CAOAxE,CAAc,CAAGD,CAAjB,CACAE,CAAY,CAAG,CAAf,CACAC,CAAa,CAAG,CACnB,CAED8G,CAAS,GACTzG,CAAa,CAAGZ,CAAC,CAAC,WAAD,CAAD,CAAekG,GAAf,GAAuB,GAAvB,CAA6BoB,CAAgB,CAAC3G,CAAS,CAACkG,IAAX,CAChE,CAnDD,CAqDA,GAAInG,CAAW,CAAC6G,SAAZ,WAAiE,IAA1B,GAAA7G,CAAW,CAAC6G,SAAvD,CAA2E,CAEvE,OADIC,CAAAA,CAAM,CAAG9G,CAAW,CAAC6G,SAAZ,EACb,CAASE,CAAC,CAAGD,CAAM,CAACE,MAAP,CAAgB,CAA7B,CAAqC,CAAL,EAAAD,CAAhC,CAAwC,EAAEA,CAA1C,CAA6C,CACzCD,CAAM,CAACC,CAAD,CAAN,CAAUE,IAAV,EACH,CACD,GAAIhC,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCgC,SAAlC,SAAJ,CAA+D,CAC3DjC,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCgC,SAAlC,CAA8C,IACjD,CACJ,CAED9G,CAAQ,CAAC6G,IAAT,GAEA3H,CAAC,CAAC,WAAD,CAAD,CAAesG,GAAf,CAAmB,SAAnB,CAA8B,MAA9B,EACAtG,CAAC,CAAC,YAAD,CAAD,CAAgBsG,GAAhB,CAAoB,SAApB,CAA+B,QAA/B,EAEAtG,CAAC,CAAC,SAAD,CAAD,CAAaoG,EAAb,CAAgB,OAAhB,CAAyB,UAAW,CAChCyB,CAAW,EACd,CAFD,CAGH,CAMD,QAASA,CAAAA,CAAT,EAAuB,CACnB,GAAI,CAACxC,CAAO,EAAZ,CAAgB,CACZd,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,eAAf,CAAgC,iBAAhC,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3CC,CAAwB,CAACD,CAAD,CAC3B,CAFD,CAGH,CALM,CAAP,CAMA,MACH,CAGD,GAAIR,CAAuB,IAAMe,CAAkB,EAAnD,CAAuD,CACnD,MACH,CAEDlC,SAAS,CAAC4E,YAAV,CAAyB5E,SAAS,CAAC4E,YAAV,GAA4B5E,SAAS,CAAC6E,eAAV,EAA6B7E,SAAS,CAAC8E,kBAAxC,CAA8D,CAC9GC,YAAY,CAAE,sBAASC,CAAT,CAAY,CACtB,MAAO,UAASC,CAAT,CAAYC,CAAZ,CAAe,CAClB,CAAClF,SAAS,CAAC6E,eAAV,EAA6B7E,SAAS,CAAC8E,kBAAxC,EAA4DK,IAA5D,CAAiEnF,SAAjE,CAA4EgF,CAA5E,CAA+EC,CAA/E,CAAkFC,CAAlF,CACH,CACJ,CAL6G,CAA9D,CAMhD,IANqB,CAAzB,CAQA,GAAI,CACA,GAA+B,IAA3B,GAAAlF,SAAS,CAAC4E,YAAV,EAAmC5E,SAAS,CAAC4E,YAAV,SAAnC,EACkB,IAAlB,GAAAQ,aADA,EAC0BA,aAAa,SAD3C,CAC2D,CACvD/D,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,gBAAf,CAAiC,iBAAjC,CAAoD,IAApD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3CC,CAAwB,CAACD,CAAD,CAC3B,CAFD,CAGH,CALM,CAAP,CAMA,MACH,CAED,GAAwB,IAApB,GAAA7D,CAAe,EAAaA,CAAe,SAA3C,EACoB,IAApB,GAAAK,CADA,EAC4BA,CAAe,SAD/C,CAC+D,CAC3DkD,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,mBAAf,CAAoC,iBAApC,CAAuD,IAAvD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3CC,CAAwB,CAACD,CAAD,CAC3B,CAFD,CAGH,CALM,CAAP,CAMA,MACH,CACJ,CAAC,MAAO0D,CAAP,CAAY,CACVhE,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,gBAAf,CAAiC,iBAAjC,CAAoD,IAApD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3CC,CAAwB,CAACD,CAAD,CAC3B,CAFD,CAGH,CALM,CAAP,CAMA5D,MAAM,CAACuH,OAAP,CAAeC,GAAf,CAAmBF,CAAnB,EACA,MACH,CAEDxC,CAAgB,CAAC,IAAD,CAAhB,CAEA,GAAgB,IAAZ,GAAAlF,CAAJ,CAAsB,CAClB,GAAII,MAAM,CAACC,GAAP,EAAcD,MAAM,CAACC,GAAP,CAAWG,eAA7B,CAA8C,CAC1CJ,MAAM,CAACC,GAAP,CAAWG,eAAX,CAA2BR,CAA3B,CACH,CAFD,IAEO,CACHI,MAAM,CAACG,SAAP,CAAiBC,eAAjB,CAAiCR,CAAjC,CACH,CACDA,CAAO,CAAG,IAAV,CACAF,CAAS,CAAG,IACf,CAED,GAAoB,IAAhB,GAAAD,CAAJ,CAA0B,CACtB,GAAIA,CAAW,CAAC6G,SAAZ,WAAiE,IAA1B,GAAA7G,CAAW,CAAC6G,SAAvD,CAA2E,CAEvE,OADIC,CAAAA,CAAM,CAAG9G,CAAW,CAAC6G,SAAZ,EACb,CAASE,CAAC,CAAGD,CAAM,CAACE,MAAP,CAAgB,CAA7B,CAAqC,CAAL,EAAAD,CAAhC,CAAwC,EAAEA,CAA1C,CAA6C,CACzCD,CAAM,CAACC,CAAD,CAAN,CAAUE,IAAV,EACH,CACD,GAAIhC,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCgC,SAAtC,CAAiD,CAC7CjC,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCgC,SAAlC,CAA8C,IACjD,CAEJ,CATD,IASO,CACHlH,CAAW,CAACiH,IAAZ,EACH,CACJ,CAEDzH,CAAQ,CAAG,CAAX,CACAC,CAAU,GAAV,CACAC,CAAQ,CAAG,EAAX,CAEAJ,CAAC,CAAC,UAAD,CAAD,CAAcmG,GAAd,CAAkB,OAAlB,EACAnG,CAAC,CAAC,SAAD,CAAD,CAAamG,GAAb,CAAiB,OAAjB,EACAnG,CAAC,CAAC,SAAD,CAAD,CAAamG,GAAb,CAAiB,iBAAjB,EA1FmB,GA4FfuC,CAAAA,CAAU,CAAG,EA5FE,CA8FfC,CAAc,CAAGC,WAAW,EAAIN,aA9FjB,CAiGnB,GAAIK,CAAc,CAACE,eAAf,CAA+B,YAA/B,CAAJ,CAAkD,CAC9CH,CAAU,CAAG,YAChB,CAFD,IAEO,IAAIC,CAAc,CAACE,eAAf,CAA+B,WAA/B,CAAJ,CAAiD,CACpDH,CAAU,CAAG,WAChB,CAFM,IAEA,IAAIC,CAAc,CAACE,eAAf,CAA+B,4BAA/B,CAAJ,CAAkE,CACrEH,CAAU,CAAG,6BAChB,CAFM,IAEA,IAAIC,CAAc,CAACE,eAAf,CAA+B,4BAA/B,CAAJ,CAAkE,CACrEH,CAAU,CAAG,6BAChB,CAFM,IAEA,IAAIC,CAAc,CAACE,eAAf,CAA+B,uBAA/B,CAAJ,CAA6D,CAChEH,CAAU,CAAG,wBAChB,CAFM,IAEA,CACHA,CAAU,CAAG,wBAChB,CAGD3H,CAAW,CAAG,CACV+H,kBAAkB,CAAE,KADV,CAEVC,kBAAkB,CAAE,IAFV,CAGVC,QAAQ,CAAEN,CAHA,CAIVO,KAAK,CAAE,CACHC,gBAAgB,GADb,CAJG,CAOVC,KAAK,CAAE,CACH,UAAa,CACTC,QAAQ,CAAE,GADD,CAETC,SAAS,CAAE,GAFF,CAGTC,QAAQ,CAAE,IAHD,CAITC,SAAS,CAAE,GAJF,CAKTC,YAAY,CAAE,CALL,CAMTC,YAAY,CAAE,EANL,CADV,CASH,SAAY,CAAC,CAAC,WAAc,MAAf,CAAD,CATT,CAPG,CAAd,CAoBA,GAAIC,CAAAA,CAAC,CAAGxG,SAAS,CAAC4E,YAAV,CAAuBG,YAAvB,CAAoClH,CAApC,CAAR,CAEA2I,CAAC,CAACC,IAAF,CAAO,SAASC,CAAT,CAAiB,CACpBlJ,CAAW,CAAGkJ,CAAd,CACA,GAAIT,CAAAA,CAAK,CAAGxD,QAAQ,CAACC,cAAT,CAAwB,QAAxB,CAAZ,CACA,GAAIuD,CAAK,CAACvB,SAAN,SAAJ,CAAmC,CAC/BuB,CAAK,CAACvB,SAAN,CAAkBlH,CAAlB,CACAyI,CAAK,CAACU,IAAN,EACH,CAHD,IAGO,CACH,GAAI5I,MAAM,CAACC,GAAP,EAAcD,MAAM,CAACC,GAAP,CAAWF,eAA7B,CAA8C,CAC1CH,CAAO,CAAGI,MAAM,CAACC,GAAP,CAAWF,eAAX,CAA2BH,CAA3B,CACb,CAFD,IAEO,CACHA,CAAO,CAAGI,MAAM,CAACG,SAAP,CAAiBJ,eAAjB,CAAiCH,CAAjC,CACb,CACDb,CAAC,CAAC,SAAD,CAAD,CAAagG,IAAb,CAAkB,KAAlB,CAAyBnF,CAAzB,CACH,CACDI,MAAM,CAACuH,OAAP,CAAeC,GAAf,CAAmB/H,CAAnB,EAEA,GAAoB,IAAhB,GAAAkI,WAAW,EAAaA,WAAW,SAAvC,CAAuD,CACnD9H,CAAQ,CAAG,GAAIwH,CAAAA,aAAJ,CAAkB5H,CAAlB,CACd,CAFD,IAEO,CACHI,CAAQ,CAAG,GAAIwH,CAAAA,aAAJ,CAAkB5H,CAAlB,CAA+BK,CAA/B,CACd,CAEDf,CAAC,CAAC,UAAD,CAAD,CAAcgG,IAAd,CAAmB,KAAnB,CAA0BhG,CAAC,CAAC,SAAD,CAAD,CAAakG,GAAb,EAA1B,EACAlG,CAAC,CAAC,UAAD,CAAD,CAAcoG,EAAd,CAAiB,OAAjB,CAA0B,UAAW,CACjCH,CAAc,EACjB,CAFD,EAGAjG,CAAC,CAAC,WAAD,CAAD,CAAesG,GAAf,CAAmB,SAAnB,CAA8B,QAA9B,EACAtG,CAAC,CAAC,YAAD,CAAD,CAAgBsG,GAAhB,CAAoB,SAApB,CAA+B,MAA/B,EAEA/B,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,gBAAf,CAAiC,iBAAjC,CAAoD,IAApD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C7E,CAAC,CAAC,SAAD,CAAD,CAAawF,IAAb,CAAkBX,CAAlB,CACH,CAFD,CAGH,CALM,CAAP,CAOAwC,CAAS,GACT,MAAO,EACV,CAtCD,EAuCCyC,KAvCD,CAuCO,SAASvB,CAAT,CAAc,CACjBhE,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,oBAAf,CAAqC,iBAArC,CAAwD,IAAxD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3CC,CAAwB,CAACD,CAAD,CAC3B,CAFD,CAGH,CALM,CAAP,CAOA5D,MAAM,CAACuH,OAAP,CAAeC,GAAf,CAAmBF,CAAnB,EACA,MAAO,CAAC,CACX,CAjDD,CAkDH,CAOD,QAASpB,CAAAA,CAAT,EAAyB,CACrB,GAAgB,CAAZ,EAAAjH,CAAJ,CAAmB,CACf,QACH,CACD,GAAe,GAAX,CAAAA,CAAJ,CAA2B,CACvB,QACH,CACD,QACH,CAQD,QAASgH,CAAAA,CAAT,CAAuB9G,CAAvB,CAAiC,CAC7B,GAAqC,CAAC,CAAlC,EAAAA,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,GAA8E,CAAC,CAAxC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,iBAAjB,CAAvC,EACkC,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CADA,EACyE,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CADxC,EAEiC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAFA,EAEuCpD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAFvC,EAGuC,CAAC,CAAxC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,iBAAjB,CAHA,EAG8E,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAH7C,EAImC,CAAC,CAApC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,aAAjB,CAJA,EAI4E,CAAC,CAApC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,aAAjB,CAJzC,EAKwC,CAAC,CAAzC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,kBAAjB,CALA,EAMsC,CAAC,CAAvC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,gBAAjB,CANA,EAM8E,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CANhD,CAMsF,CAClF,MAAO,OACV,CAED,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,GAAwE,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAvC,EACkC,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CADA,EACyE,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CADxC,EAEiC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAFA,EAGiC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAHA,EAG6E,CAAC,CAAvC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,gBAAjB,CAH3C,CAGqF,CACjF,MAAO,OACV,CAED,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,GAAyE,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CAAvC,EACiC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CADA,EACyE,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CAD3C,CACiF,CAC7E,MAAO,OACV,CAED,MAAO,KACV,CAQD,QAAS8D,CAAAA,CAAT,CAA0BlH,CAA1B,CAAoC,CAChC,GAAqC,CAAC,CAAlC,EAAAA,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,GAA8E,CAAC,CAAxC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,iBAAjB,CAA3C,CAAsF,CAClF,MAAO,KACV,CACD,GAAsC,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,GAAyE,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAxC,EACkC,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CADA,EACyE,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAD5C,CACiF,CAC7E,MAAO,MACV,CACD,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,GAAwE,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAvC,EACiC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CADJ,CACyC,CACrC,MAAO,KACV,CACD,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAJ,CAAyC,CACrC,MAAO,KACV,CACD,GAA2C,CAAC,CAAxC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,iBAAjB,CAAJ,CAA+C,CAC3C,MAAO,KACV,CACD,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,GAAwE,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAvC,EACiC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CADA,EACwE,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CADvC,EAEkC,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CAFJ,CAE0C,CACtC,MAAO,MACV,CACD,GAAuC,CAAC,CAApC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,aAAjB,GAA4E,CAAC,CAApC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,aAAjB,CAA7C,CAAoF,CAChF,MAAO,KACV,CACD,GAA4C,CAAC,CAAzC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,kBAAjB,CAAJ,CAAgD,CAC5C,MAAO,KACV,CACD,GAA0C,CAAC,CAAvC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,gBAAjB,CAAJ,CAA8C,CAC1C,MAAO,KACV,CAED,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAJ,CAAyC,CACrC,MAAO,KACV,CACD,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAJ,CAAyC,CACrC,MAAO,KACV,CACD,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAJ,CAAyC,CACrC,MAAO,KACV,CACD,GAA0C,CAAC,CAAvC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,gBAAjB,CAAJ,CAA8C,CAC1C,MAAO,KACV,CAED,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAJ,CAAyC,CACrC,MAAO,KACV,CACD,GAAsC,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CAAJ,CAA0C,CACtC,MAAO,KACV,CACD,GAAqC,CAAC,CAAlC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,WAAjB,CAAJ,CAAyC,CACrC,MAAO,KACV,CACD,GAAsC,CAAC,CAAnC,EAAApD,CAAQ,CAACoD,OAAT,CAAiB,YAAjB,CAAJ,CAA0C,CACtC,MAAO,MACV,CAED,MAAO,MACV,CAMD,QAAS6D,CAAAA,CAAT,EAAqB,CACjB,GAAgB,IAAZ,GAAAxG,CAAO,EACO,IAAd,GAAAF,CADA,EAEmB,CAAnB,GAAAA,CAAS,CAACmG,IAFV,EAGA,KAAA3G,CAHA,EAIqB,EAArB,GAAAH,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,EAJA,EAKqB,EAArB,GAAAlG,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,EALA,EAMa,EAAb,GAAA9F,CANA,EAOa,KAAb,GAAAA,CAPJ,CAOwB,CAEpBJ,CAAC,CAAC,eAAD,CAAD,CAAmB+J,IAAnB,CAAwB,UAAxB,KACA/J,CAAC,CAAC,QAAD,CAAD,CAAYkG,GAAZ,CAAgB,EAAhB,CACH,CAXD,IAWO,CAEHlG,CAAC,CAAC,eAAD,CAAD,CAAmB+J,IAAnB,CAAwB,UAAxB,IACH,CACJ,CAOD,QAASC,CAAAA,CAAT,CAA2BC,CAA3B,CAAyC,CACrCjK,CAAC,CAAC,cAAD,CAAD,CAAkBwF,IAAlB,CAAuB,EAAvB,EACAxF,CAAC,CAAC,cAAD,CAAD,CAAkBkK,MAAlB,CAAyB,uBAAyBD,CAAzB,CAAwC,aAAjE,EAEAlF,CAAmB,GACnBC,CAAkB,EACrB,CAWD,QAASmF,CAAAA,CAAT,CAA6BC,CAA7B,CAAiCC,CAAjC,CAAuCC,CAAvC,CAA6CC,CAA7C,CAA0DC,CAA1D,CAAqE,CAEjEjG,OAAO,CAAC,CAAC,UAAD,CAAa,mBAAb,CAAD,CAAoC,SAASC,CAAT,CAAciG,CAAd,CAA4B,CAUnEjG,CAAG,CAACkG,WAAJ,CATc,CACV,CAACC,GAAG,CAAE,gBAAN,CAAwBC,SAAS,CAAE,iBAAnC,CADU,CAEV,CAACD,GAAG,CAAE,gBAAN,CAAwBC,SAAS,CAAE,iBAAnC,CAFU,CAGV,CAACD,GAAG,CAAE,aAAN,CAAqBC,SAAS,CAAE,iBAAhC,CAHU,CAIV,CAACD,GAAG,CAAE,aAAN,CAAqBC,SAAS,CAAE,iBAAhC,CAJU,CAKV,CAACD,GAAG,CAAE,aAAN,CAAqBC,SAAS,CAAE,iBAAhC,CALU,CAMV,CAACD,GAAG,CAAE,kBAAN,CAA0BC,SAAS,CAAE,iBAArC,CANU,CAOV,CAACD,GAAG,CAAE,cAAN,CAAsBC,SAAS,CAAE,gBAAjC,CAPU,CASd,EAAyBjB,IAAzB,CAA8B,SAASkB,CAAT,CAAkB,CAC5C,GAAIC,CAAAA,CAAM,CAAG,OAASD,CAAO,CAAC,CAAD,CAAhB,CAAsB,OAAnC,CACAC,CAAM,EAAI,wCAAV,CACAA,CAAM,EAAI,WAAaD,CAAO,CAAC,CAAD,CAApB,CAA0B,WAA1B,CAAwCT,CAAxC,CAA6C,YAAvD,CACAU,CAAM,EAAI,WAAaD,CAAO,CAAC,CAAD,CAApB,CAA0B,WAA1B,CAAwCR,CAAxC,CAA+C,YAAzD,CACAS,CAAM,EAAI,WAAaD,CAAO,CAAC,CAAD,CAApB,CAA0B,WAA1B,CAAwCP,CAAxC,CAA+C,YAAzD,CACAQ,CAAM,EAAI,WAAaD,CAAO,CAAC,CAAD,CAApB,CAA0B,WAA1B,CAAwCN,CAAxC,CAAsD,YAAhE,CACAO,CAAM,EAAI,WAAaD,CAAO,CAAC,CAAD,CAApB,CAA0B,WAA1B,CAAwCL,CAAxC,CAAoD,YAA9D,CACAM,CAAM,EAAI,UAAV,CACAA,CAAM,EAAI,MAAV,CACAA,CAAM,EAAI,0BAA0BD,CAAO,CAAC,CAAD,CAAjC,CAAuC,aAAjD,CACA7K,CAAC,CAAC,cAAD,CAAD,CAAkBwF,IAAlB,CAAuBsF,CAAvB,EACA,MAAO,EACV,CAbD,EAaGC,IAbH,CAaQN,CAAY,CAACO,SAbrB,CAcH,CAxBM,CAAP,CA2BAC,CAAkB,GAClBjG,CAAkB,EACrB,CAMD,QAASkG,CAAAA,CAAT,EAA4B,CACxBlL,CAAC,CAAC,YAAD,CAAD,CAAgBwF,IAAhB,CAAqB,EAArB,EACAxF,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,CAAe,EAAf,EAEA7F,CAAc,CAAG,EAAjB,CACAC,CAAY,CAAG,CAAf,CACAC,CAAa,CAAG,CAAhB,CAEAwE,CAAmB,GACnBC,CAAkB,EACrB,CAQD,QAASmG,CAAAA,CAAT,CAAyB3G,CAAzB,CAA8B,CAE1B,GAAI,KADQ,eACR,CAAM4G,IAAN,CAAW5G,CAAX,CAAJ,CAA8B,CAC1B,QACH,CAFD,IAEO,CACH,QACH,CACJ,CAQD,QAAS6G,CAAAA,CAAT,CAAyB7G,CAAzB,CAA8B,CAE1B,GAAI,KADQ,kCACR,CAAM4G,IAAN,CAAW5G,CAAX,CAAJ,CAA8B,CAC1B,QACH,CAFD,IAEO,CACH,QACH,CACJ,CAOD,QAAS8G,CAAAA,CAAT,EAAyB,IACjBC,CAAAA,CAAO,CAAGvL,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,EADO,CAEjBsF,CAAO,CAAGxL,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,EAFO,CAGjBuF,CAAO,CAAGzL,CAAC,CAAC,cAAD,CAAD,CAAkBkG,GAAlB,EAHO,CAKjBwF,CAAI,GALa,CAOrB,GAAI,KAAAP,CAAe,CAACI,CAAD,CAAnB,CAAwC,CACpChH,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,YAAf,CAA6B,iBAA7B,CAAgD,IAAhD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C5D,MAAM,CAACmG,KAAP,CAAavC,CAAb,CACH,CAFD,CAGH,CALM,CAAP,CAMA6G,CAAI,GACP,CAED,GAAI,KAAAL,CAAe,CAACG,CAAD,CAAnB,CAAwC,CACpCjH,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,YAAf,CAA6B,iBAA7B,CAAgD,IAAhD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C5D,MAAM,CAACmG,KAAP,CAAavC,CAAb,CACH,CAFD,CAGH,CALM,CAAP,CAMA6G,CAAI,GACP,CAED,GAAI,KAAAP,CAAe,CAACM,CAAD,CAAnB,CAAwC,CACpClH,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,YAAf,CAA6B,iBAA7B,CAAgD,IAAhD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C5D,MAAM,CAACmG,KAAP,CAAavC,CAAb,CACH,CAFD,CAGH,CALM,CAAP,CAMA6G,CAAI,GACP,CAED,MAAOA,CAAAA,CACV,CAOD,QAASC,CAAAA,CAAT,EAA6B,CAEzB,GAAI,KAAAL,CAAa,EAAjB,CAA+B,CAC3B,QACH,CAED,GAAI,KAAAnE,CAAa,EAAjB,CAA+B,CAC3B5C,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,gBAAf,CAAiC,iBAAjC,CAAoD,IAApD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C5D,MAAM,CAACmG,KAAP,CAAavC,CAAb,CACH,CAFD,CAGH,CALM,CAAP,CAMA,QACH,CAED7E,CAAC,CAAC,eAAD,CAAD,CAAmB+J,IAAnB,CAAwB,UAAxB,KACA6B,CAAoB,GAEpB,QACH,CAMD,QAASC,CAAAA,CAAT,EAA+B,CAE3B,GAA8D,IAA1D,GAAAC,MAAM,CAACnG,QAAP,CAAgBC,cAAhB,CAA+B,qBAA/B,GAC6D,IAA7D,GAAAkG,MAAM,CAACnG,QAAP,CAAgBC,cAAhB,CAA+B,qBAA/B,EAAsD,CAAtD,CADJ,CACuE,IAC/DmG,CAAAA,CAAO,CAAG/L,CAAC,CAAC,MAAD,CAAS8L,MAAM,CAACnG,QAAhB,CADoD,CAG/DnB,CAAG,CAAG,4FAHyD,CAInEuH,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEAA,CAAG,CAAG,gGAAN,CACAuH,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEA,GAAIwH,CAAAA,CAAW,CAAGhM,CAAC,CAAC,cAAD,CAAD,CAAkBkG,GAAlB,EAAlB,CACA1B,CAAG,CAAG,+EAAN,CACAA,CAAG,CAAGA,CAAG,CAAGwH,CAAN,CAAoB,KAA1B,CACAD,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEA,GAAIyH,CAAAA,CAAS,CAAGjM,CAAC,CAAC,YAAD,CAAD,CAAgBkG,GAAhB,EAAhB,CACA1B,CAAG,CAAG,yFAAN,CACAA,CAAG,CAAGA,CAAG,CAAGyH,CAAN,CAAkB,KAAxB,CACAF,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEA,GAAI0H,CAAAA,CAAQ,CAAGlM,CAAC,CAAC,WAAD,CAAD,CAAekG,GAAf,EAAf,CACA1B,CAAG,CAAG,uFAAN,CACAA,CAAG,CAAGA,CAAG,CAAG0H,CAAN,CAAiB,KAAvB,CACAH,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEA,GAAI2H,CAAAA,CAAK,CAAGnM,CAAC,CAAC,eAAD,CAAD,CAAmBkG,GAAnB,EAAZ,CACA1B,CAAG,CAAG,kFAA6E2H,CAA7E,CAAqF,KAA3F,CACAJ,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEA,GAAI4H,CAAAA,CAAM,CAAGpM,CAAC,CAAC,gBAAD,CAAD,CAAoBkG,GAApB,EAAb,CACA1B,CAAG,CAAG,oFAA+E4H,CAA/E,CAAwF,KAA9F,CACAL,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEA,GAAI6H,CAAAA,CAAM,CAAGrM,CAAC,CAAC,gBAAD,CAAD,CAAoBkG,GAApB,EAAb,CACA1B,CAAG,CAAG,gGAA2F6H,CAA3F,CAAoG,KAA1G,CACAN,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEAA,CAAG,CAAG,0FAAN,CACAuH,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEAA,CAAG,CAAG,kGAAN,CACAuH,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,EAEAA,CAAG,CAAG,oGAAN,CACAuH,CAAO,CAAC7B,MAAR,CAAe1F,CAAf,CACH,CACJ,CAQD,QAAS8H,CAAAA,CAAT,CAAgClC,CAAhC,CAAoCC,CAApC,CAA0C,CACtC,GAAW,IAAP,GAAAD,CAAE,EAAoB,EAAP,GAAAA,CAAf,EAC0D,IAA1D,GAAA0B,MAAM,CAACnG,QAAP,CAAgBC,cAAhB,CAA+B,qBAA/B,CADA,EAE6D,IAA7D,GAAAkG,MAAM,CAACnG,QAAP,CAAgBC,cAAhB,CAA+B,qBAA/B,EAAsD,CAAtD,CAFJ,CAEuE,CAEnE5F,CAAC,CAAC,sBAAD,CAAyB8L,MAAM,CAACnG,QAAhC,CAAD,CAA2CO,GAA3C,CAA+CkE,CAA/C,EAEApK,CAAC,CAAC,wBAAD,CAA2B8L,MAAM,CAACnG,QAAlC,CAAD,CAA6CO,GAA7C,CAAiDmE,CAAjD,EAEArK,CAAC,CAAC,qBAAD,CAAwB8L,MAAM,CAACnG,QAA/B,CAAD,CAA0CO,GAA1C,CAA8C7F,CAA9C,EACAL,CAAC,CAAC,yBAAD,CAA4B8L,MAAM,CAACnG,QAAnC,CAAD,CAA8CO,GAA9C,CAAkD5F,CAAlD,EACAN,CAAC,CAAC,0BAAD,CAA6B8L,MAAM,CAACnG,QAApC,CAAD,CAA+CO,GAA/C,CAAmD3F,CAAnD,CACH,CACJ,CAMD,QAAS0K,CAAAA,CAAT,EAA8B,CAE1BjL,CAAC,CAAC,uBAAD,CAA0B8L,MAAM,CAACnG,QAAjC,CAAD,CAA4CoE,IAA5C,CAAiD,UAAjD,KACA/J,CAAC,CAAC,uBAAD,CAA0B8L,MAAM,CAACnG,QAAjC,CAAD,CAA4CW,GAA5C,CAAgD,CAACiG,OAAO,CAAE,KAAV,CAAhD,CACH,CAMD,QAASxH,CAAAA,CAAT,EAA+B,CAE3B/E,CAAC,CAAC,uBAAD,CAA0B8L,MAAM,CAACnG,QAAjC,CAAD,CAA4CoE,IAA5C,CAAiD,UAAjD,KACA/J,CAAC,CAAC,uBAAD,CAA0B8L,MAAM,CAACnG,QAAjC,CAAD,CAA4CW,GAA5C,CAAgD,CAACiG,OAAO,CAAE,KAAV,CAAhD,CACH,CAMD,QAASvH,CAAAA,CAAT,EAA8B,CAE1BhF,CAAC,CAAC,uBAAD,CAA0B8L,MAAM,CAACnG,QAAjC,CAAD,CAA4CoE,IAA5C,CAAiD,UAAjD,KACA/J,CAAC,CAAC,uBAAD,CAA0B8L,MAAM,CAACnG,QAAjC,CAAD,CAA4CW,GAA5C,CAAgD,CAACiG,OAAO,CAAE,KAAV,CAAhD,CACH,CAMD,QAASC,CAAAA,CAAT,EAA+B,CAE3BxM,CAAC,CAAC,uBAAD,CAA0B8L,MAAM,CAACnG,QAAjC,CAAD,CAA4CoE,IAA5C,CAAiD,UAAjD,KACA/J,CAAC,CAAC,uBAAD,CAA0B8L,MAAM,CAACnG,QAAjC,CAAD,CAA4CW,GAA5C,CAAgD,CAACiG,OAAO,CAAE,KAAV,CAAhD,CACH,CAMD,QAASX,CAAAA,CAAT,EAAgC,IACxBa,CAAAA,CAAU,CAAGzM,CAAC,CAAC,cAAD,CAAD,CAAkBkG,GAAlB,EADW,CAExBwG,CAAE,CAAG1M,CAAC,CAAC,KAAD,CAAD,CAASkG,GAAT,EAFmB,CAI5BnB,CAAmB,GACnByH,CAAmB,GAEnBX,CAAmB,GAGnBc,CAAiB,CAACF,CAAD,CAAaC,CAAb,CACpB,CAUD,QAASE,CAAAA,CAAT,CAA2BH,CAA3B,CAAuCC,CAAvC,CAA2CG,CAA3C,CAA0D,IAClDC,CAAAA,CAAE,CAAG,GAAIC,CAAAA,QADyC,CAElDrB,CAFkD,CAKtDoB,CAAE,CAAC5C,MAAH,CAAU,QAAV,CAAoB,QAApB,EACA4C,CAAE,CAAC5C,MAAH,CAAU,IAAV,CAAgBwC,CAAhB,EACAI,CAAE,CAAC5C,MAAH,CAAU,eAAV,CAA2B2C,CAA3B,EAiBA7M,CAAC,CAACgN,IAAF,CAHiBP,CAAU,CAAG,2CAG9B,CAde,CACX5F,IAAI,CAAE,MADK,CAEXD,IAAI,CAAEkG,CAFK,CAGXG,KAAK,GAHM,CAIXC,WAAW,GAJA,CAKXC,aAAa,CAAE,OALJ,CAMXC,WAAW,GANA,CAOXC,KAAK,GAPM,CAQXC,QAAQ,CAAE,KARC,CAcf,EAGC1I,IAHD,CAGM,SAAS2I,CAAT,CAAkB,CAEpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClB7B,CAAI,GACP,CACDA,CAAI,GACP,CATD,EAUCX,IAVD,CAUM,SAASwC,CAAT,CAAkB,CACpB7B,CAAI,GAAJ,CACA,GAAgB,IAAZ,GAAA6B,CAAJ,CAAsB,CAClBtM,MAAM,CAACuH,OAAP,CAAegF,GAAf,CAAmBD,CAAnB,CACH,CACJ,CAfD,EAiBA,MAAO7B,CAAAA,CACV,CAQD,QAASiB,CAAAA,CAAT,CAA2BF,CAA3B,CAAuCC,CAAvC,CAA2C,IACnCG,CAAAA,CADmC,CAEnCY,CAFmC,CAanCC,CAAU,CAAGjB,CAAU,CAAG,4CAAb,CAA4DC,CAbtC,CAcvCgB,CAAU,CAAGA,CAAU,CAAG,4CAA1B,CACAA,CAAU,CAAGA,CAAU,CAAG,uBAAb,CAAuCC,SAAS,CAAC/M,CAAD,CAA7D,CACA8M,CAAU,CAAGA,CAAU,CAAG,wBAAb,CAAwC/M,CAAS,CAACmG,IAA/D,CACA4G,CAAU,CAAGA,CAAU,CAAG,4BAAb,CAA4ChM,EAAa,CAACG,IAAvE,CAGA7B,CAAC,CAACgN,IAAF,CACIU,CADJ,CAhBe,CACX7G,IAAI,CAAE,KADK,CAEXoG,KAAK,GAFM,CAGXI,KAAK,GAHM,CAIXH,WAAW,GAJA,CAKXC,aAAa,CAAE,OALJ,CAMXG,QAAQ,CAAE,KANC,CAgBf,EAGC1I,IAHD,CAGM,SAAS2I,CAAT,CAAkB,CAEpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBvD,CAAiB,CAAC,8DAAD,CAAjB,CACA,MACH,CAGDyD,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,MAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9E7D,CAAiB,CAAC,oCAAsCyD,CAAQ,CAACI,IAAT,EAAtC,CAAwD,GAAzD,CAAjB,CACA,MACH,CAEDJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,QAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9E7D,CAAiB,CAAC,sEAAD,CAAjB,CACA,MACH,CAED,GAAI8D,CAAAA,CAAiB,CAAGL,CAAQ,CAACI,IAAT,EAAxB,CACA,GAAIC,CAAiB,EAAIrL,EAAmB,CAACC,OAA7C,CAAsD,CAClDsH,CAAiB,CAAC,0DAA4D8D,CAA5D,CAAgF,GAAjF,CAAjB,CACA,MACH,CAGDL,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,IAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9E7D,CAAiB,CAAC,gEAAD,CAAjB,CACA,MACH,CACD6C,CAAa,CAAGY,CAAQ,CAACI,IAAT,EAAhB,CAEAE,UAAU,CAAC,UAAW,CAClBC,CAAgB,CAACvB,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CACnB,CAFS,CAEP,EAFO,CAIb,CA5CD,EA6CC9B,IA7CD,CA6CM,SAASwC,CAAT,CAAkB,CACpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBtM,MAAM,CAACuH,OAAP,CAAegF,GAAf,CAAmBD,CAAnB,CACH,CACDvD,CAAiB,CAAC,qEAAD,CACpB,CAlDD,CAmDH,CASD,QAASgE,CAAAA,CAAT,CAA0BvB,CAA1B,CAAsCC,CAAtC,CAA0CG,CAA1C,CAAyD,IACjDY,CAAAA,CADiD,CAEjDQ,CAFiD,CAGjDC,CAAO,CAAG,EAHuC,CAIjDC,CAAS,CAAG,EAJqC,CAKjDC,CAAS,CAAG,EALqC,CAMjDC,CAAgB,CAAG,EAN8B,CAOjDC,CAAc,CAAG,EAPgC,CASjD/C,CAAO,CAAGvL,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,EATuC,CAUjDsF,CAAO,CAAGxL,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,EAVuC,CAWjDuF,CAAO,CAAGzL,CAAC,CAAC,cAAD,CAAD,CAAkBkG,GAAlB,EAXuC,CAYjDqI,CAAS,CAAGvO,CAAC,CAAC,YAAD,CAAD,CAAgBkG,GAAhB,EAZqC,CAajDsE,CAAS,CAAGxK,CAAC,CAAC,YAAD,CAAD,CAAgBkG,GAAhB,EAbqC,CAerDqF,CAAO,CAAGA,CAAO,CAACiD,IAAR,EAAV,CACAhD,CAAO,CAAGA,CAAO,CAACgD,IAAR,EAAV,CACA,GAAgB,IAAZ,GAAA/C,CAAJ,CAAsB,CAClBA,CAAO,CAAGA,CAAO,CAAC+C,IAAR,EACb,CAED,GAAI1B,CAAAA,CAAE,CAAG,GAAIC,CAAAA,QAAb,CAGAD,CAAE,CAAC5C,MAAH,CAAU,QAAV,CAAoB,KAApB,EACA4C,CAAE,CAAC5C,MAAH,CAAU,IAAV,CAAgBwC,CAAhB,EACAI,CAAE,CAAC5C,MAAH,CAAU,kBAAV,CAA8B,mBAA9B,EACA4C,CAAE,CAAC5C,MAAH,CAAU,iBAAV,CAA6B5I,EAAU,CAACC,KAAxC,EACAuL,CAAE,CAAC5C,MAAH,CAAU,kBAAV,CAA8B,CAA9B,EACA4C,CAAE,CAAC5C,MAAH,CAAU,YAAV,CAAwBqB,CAAxB,EACAuB,CAAE,CAAC5C,MAAH,CAAU,YAAV,CAAwBsB,CAAxB,EACA,GAAgB,IAAZ,GAAAC,CAAO,EAAyB,EAAZ,GAAAA,CAAxB,CAAwC,CACpCqB,CAAE,CAAC5C,MAAH,CAAU,mBAAV,CAA+BuB,CAA/B,CACH,CAFD,IAEO,CACHqB,CAAE,CAAC5C,MAAH,CAAU,mBAAV,CAA+B,EAA/B,CACH,CAED4C,CAAE,CAAC5C,MAAH,CAAU,kBAAV,CAA8BlK,CAAC,CAAC,aAAD,CAAD,CAAiBkG,GAAjB,EAA9B,EAEA,GAAkB,IAAd,GAAAqI,CAAS,EAA2B,EAAd,GAAAA,CAA1B,CAA4C,CACxCzB,CAAE,CAAC5C,MAAH,CAAU,uBAAV,CAAmCqE,CAAnC,CACH,CAEDzB,CAAE,CAAC5C,MAAH,CAAU,iBAAV,CAA6BM,CAA7B,EACAsC,CAAE,CAAC5C,MAAH,CAAU,cAAV,CAA0BM,CAA1B,EAiBAxK,CAAC,CAACgN,IAAF,CAHiBP,CAAU,CAAG,kCAG9B,CAde,CACX5F,IAAI,CAAE,MADK,CAEXD,IAAI,CAAEkG,CAFK,CAGXG,KAAK,GAHM,CAIXI,KAAK,GAJM,CAKXH,WAAW,GALA,CAMXC,aAAa,CAAE,OANJ,CAOXC,WAAW,GAPA,CAQXE,QAAQ,CAAE,KARC,CAcf,EAGC1I,IAHD,CAGM,SAAS2I,CAAT,CAAkB,CAEpB,GAAgB,IAAZ,GAAAA,CAAO,EAAa,QAAOA,CAAP,UAAxB,CAAsD,CAClDX,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,6DAAD,CAAjB,CACA,MACH,CAGDyD,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,MAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9EjB,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,mCAAqCyD,CAAQ,CAACI,IAAT,EAArC,CAAuD,GAAxD,CAAjB,CACA,MACH,CAGDJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,QAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9EjB,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,kEAAD,CAAjB,CACA,MACH,CAGDiE,CAAW,CAAGR,CAAQ,CAACI,IAAT,EAAd,CAEA,GAAII,CAAW,EAAInM,EAAY,CAACU,gBAAhC,CAAkD,CAC9CoK,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,oDAAsDiE,CAAtD,CAAoE,GAArE,CAAjB,CACA,MACH,CAGDR,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,IAAhB,CAAX,CAEAM,CAAO,CAAGT,CAAQ,CAACI,IAAT,EAAV,CAEAJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,MAAhB,CAAX,CAEAO,CAAS,CAAGV,CAAQ,CAACI,IAAT,EAAZ,CAEAJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,MAAhB,CAAX,CAEAQ,CAAS,CAAGX,CAAQ,CAACI,IAAT,EAAZ,CAEAJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,aAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAE9EQ,CAAgB,CAAGZ,CAAQ,CAACI,IAAT,EACtB,CAHD,IAGO,CACHQ,CAAgB,CAAG,EACtB,CAEDZ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,WAAhB,CAAX,CAEAU,CAAc,CAAGb,CAAQ,CAACI,IAAT,EAAjB,CAEA,GAAgB,IAAZ,GAAAK,CAAO,EAAyB,EAAZ,GAAAA,CAApB,EAAoD,IAAd,GAAAC,CAAtC,EAA0E,EAAd,GAAAA,CAA5D,EACc,IAAd,GAAAC,CADA,EACoC,EAAd,GAAAA,CADtB,EAC6D,IAAnB,GAAAE,CAD1C,EACwF,EAAnB,GAAAA,CADrE,EAEY,EAAZ,GAAA7C,CAAO,GAAiC,IAArB,GAAA4C,CAAgB,EAAkC,EAArB,GAAAA,CAAzC,CAFX,CAE8E,CAC1EzB,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,wCAAD,CAAjB,CACA,MACH,CAGD+D,UAAU,CAAC,UAAW,CAClBU,CAAe,CAAChC,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAgCqB,CAAhC,CAClB,CAFS,CAEP,EAFO,CAIb,CA7ED,EA8ECnD,IA9ED,CA8EM,SAASwC,CAAT,CAAkB,CACpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBtM,MAAM,CAACuH,OAAP,CAAegF,GAAf,CAAmBD,CAAnB,CACH,CACDX,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,oEAAD,CAEpB,CArFD,CAsFH,CAUD,QAASyE,CAAAA,CAAT,CAAyBhC,CAAzB,CAAqCC,CAArC,CAAyCG,CAAzC,CAAwDqB,CAAxD,CAAiE,IACzDT,CAAAA,CADyD,CAEzDX,CAAE,CAAG,GAAIC,CAAAA,QAFgD,CAI7D/M,CAAC,CAAC,cAAD,CAAD,CAAkBwF,IAAlB,CAAuB,EAAvB,EAEAjB,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,oBAAf,CAAqC,iBAArC,CAAwD,IAAxD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C7E,CAAC,CAAC,cAAD,CAAD,CAAkBkK,MAAlB,CAAyBrF,CAAe,CAAG,MAA3C,CACH,CAFD,CAGH,CALM,CAAP,CAOAN,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,UAAf,CAA2B,iBAA3B,CAA8C,IAA9C,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C,GAAIL,CAAAA,CAAG,CAAG,MAAQK,CAAlB,CACAL,CAAG,CAAGA,CAAG,CAAG,iEAAZ,CACAxE,CAAC,CAAC,cAAD,CAAD,CAAkBkK,MAAlB,CAAyB1F,CAAzB,CACH,CAJD,CAKH,CAPM,CAAP,CAUAsI,CAAE,CAAC5C,MAAH,CAAU,QAAV,CAAoB,QAApB,EACA4C,CAAE,CAAC5C,MAAH,CAAU,IAAV,CAAgBwC,CAAhB,EACAI,CAAE,CAAC5C,MAAH,CAAU,eAAV,CAA2B2C,CAA3B,EACAC,CAAE,CAAC5C,MAAH,CAAU,UAAV,CAAsBvJ,CAAtB,CAAiCgN,SAAS,CAAC/M,CAAD,CAA1C,CAA2DD,CAAS,CAACmG,IAArE,EACAgG,CAAE,CAAC5C,MAAH,CAAU,QAAV,KACA4C,CAAE,CAAC5C,MAAH,CAAU,YAAV,KACA4C,CAAE,CAAC5C,MAAH,CAAU,UAAV,CAAsB,CAAtB,EA2BAlK,CAAC,CAACgN,IAAF,CAHiBP,CAAU,CAAG,2CAG9B,CAxBe,CACX5F,IAAI,CAAE,MADK,CAEXD,IAAI,CAAEkG,CAFK,CAGXG,KAAK,GAHM,CAIXI,KAAK,GAJM,CAKXH,WAAW,GALA,CAMXC,aAAa,CAAE,OANJ,CAOXC,WAAW,GAPA,CAQXE,QAAQ,CAAE,KARC,CASXoB,GAAG,CAAE,cAAW,CACZ,GAAIC,CAAAA,CAAG,CAAG3O,CAAC,CAAC4O,YAAF,CAAeF,GAAf,EAAV,CACA,GAAIC,CAAG,CAACE,MAAR,CAAgB,CACZF,CAAG,CAACE,MAAJ,CAAWC,gBAAX,CAA4B,UAA5B,CAAwC,SAASC,CAAT,CAAY,CAChD,GAAIC,CAAAA,CAAQ,CAAGC,QAAQ,CAAsB,GAArB,EAAAF,CAAC,CAACG,MAAF,CAAWH,CAAC,CAACI,KAAb,CAAD,CAAvB,CACAnP,CAAC,CAAC,SAAD,CAAD,CAAawF,IAAb,CAAkByJ,QAAQ,CAACD,CAAD,CAA1B,CACH,CAHD,IAIH,CACD,MAAOL,CAAAA,CACV,CAlBU,CAwBf,EAGC/J,IAHD,CAGM,SAAS2I,CAAT,CAAkB,CAEpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBX,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,2DAAD,CAAjB,CACA,MACH,CAGDyD,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,MAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9EjB,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,iCAAmCyD,CAAQ,CAACI,IAAT,EAAnC,CAAqD,GAAtD,CAAjB,CACA,MACH,CAGDJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,QAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9EjB,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,iEAAD,CAAjB,CACA,MACH,CAED,GAAI8D,CAAAA,CAAiB,CAAGL,CAAQ,CAACI,IAAT,EAAxB,CACA,GAAIC,CAAiB,EAAIrL,EAAmB,CAACG,WAAzC,EACAkL,CAAiB,EAAIrL,EAAmB,CAACE,cAD7C,CAC6D,CACzDiK,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,uDAAyD8D,CAAzD,CAA6E,GAA9E,CAAjB,CACA,MACH,CALD,IAKO,CACH7M,MAAM,CAACuH,OAAP,CAAeC,GAAf,CAAmB,mCAAnB,CACH,CAEDlE,OAAO,CAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAChC,GAAIC,CAAAA,CAAO,CAAGD,CAAG,CAACE,UAAJ,CAAe,aAAf,CAA8B,iBAA9B,CAAiD,IAAjD,CAAd,CACA1E,CAAC,CAAC2E,IAAF,CAAOF,CAAP,EAAgBG,IAAhB,CAAqB,SAASC,CAAT,CAA0B,CAC3C7E,CAAC,CAAC,cAAD,CAAD,CAAkBkK,MAAlB,CAAyBrF,CAAe,CAAG,MAA3C,CACH,CAFD,CAGH,CALM,CAAP,CAQAkJ,UAAU,CAAC,UAAW,CAClBqB,CAAkB,CAAC3C,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAgCqB,CAAhC,CACrB,CAFS,CAEP,GAFO,CAIb,CAnDD,EAoDCnD,IApDD,CAoDM,SAASwC,CAAT,CAAkB,CACpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBtM,MAAM,CAACuH,OAAP,CAAegF,GAAf,CAAmBD,CAAnB,CACH,CACDX,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,kEAAD,CAEpB,CA3DD,CA4DH,CAUD,QAASoF,CAAAA,CAAT,CAA4B3C,CAA5B,CAAwCC,CAAxC,CAA4CG,CAA5C,CAA2DqB,CAA3D,CAAoE,IAC5DD,CAAAA,CAD4D,CAE5DE,CAAS,CAAG,EAFgD,CAG5DC,CAAS,CAAG,EAHgD,CAI5DC,CAAgB,CAAG,EAJyC,CAK5DC,CAAc,CAAG,EAL2C,CAO5Db,CAP4D,CAU5DX,CAAE,CAAG,GAAIC,CAAAA,QAVmD,CAWhED,CAAE,CAAC5C,MAAH,CAAU,QAAV,CAAoB,YAApB,EACA4C,CAAE,CAAC5C,MAAH,CAAU,IAAV,CAAgBwC,CAAhB,EACAI,CAAE,CAAC5C,MAAH,CAAU,SAAV,CAAqBgE,CAArB,EACApB,CAAE,CAAC5C,MAAH,CAAU,qBAAV,CAAiC,kCAAjC,EACA4C,CAAE,CAAC5C,MAAH,CAAU,gBAAV,CAA4B2C,CAA5B,EAiBA7M,CAAC,CAACgN,IAAF,CAHiBP,CAAU,CAAG,yCAG9B,CAde,CACX5F,IAAI,CAAE,MADK,CAEXD,IAAI,CAAEkG,CAFK,CAGXG,KAAK,GAHM,CAIXI,KAAK,GAJM,CAKXH,WAAW,GALA,CAMXC,aAAa,CAAE,OANJ,CAOXC,WAAW,GAPA,CAQXE,QAAQ,CAAE,KARC,CAcf,EAGC1I,IAHD,CAGM,SAAS2I,CAAT,CAAkB,CAEpB,GAAgB,IAAZ,GAAAA,CAAO,EAAa,QAAOA,CAAP,UAAxB,CAAsD,CAClDX,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,+DAAD,CAAjB,CACA,MACH,CAGDyD,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,MAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9EjB,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,qCAAuCyD,CAAQ,CAACI,IAAT,EAAvC,CAAyD,GAA1D,CAAjB,CACA,MACH,CAGDJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,QAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAC9EjB,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,mEAAD,CAAjB,CACA,MACH,CAGDiE,CAAW,CAAGR,CAAQ,CAACI,IAAT,EAAd,CAEA,GAAII,CAAW,EAAInM,EAAY,CAACK,WAA5B,EAA2C8L,CAAW,EAAInM,EAAY,CAACO,aAAvE,EACA4L,CAAW,EAAInM,EAAY,CAACI,gBAD5B,EACgD+L,CAAW,EAAInM,EAAY,CAACuN,MAD5E,EAEApB,CAAW,EAAInM,EAAY,CAACwN,SAFhC,CAE2C,CACvC1C,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,uDAAyDiE,CAAzD,CAAuE,GAAxE,CAAjB,CACA,MACH,CAGDR,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,IAAhB,CAAX,CAEAM,CAAO,CAAGT,CAAQ,CAACI,IAAT,EAAV,CAEAJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,MAAhB,CAAX,CAEAO,CAAS,CAAGV,CAAQ,CAACI,IAAT,EAAZ,CAEAJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,MAAhB,CAAX,CAEAQ,CAAS,CAAGX,CAAQ,CAACI,IAAT,EAAZ,CAEAJ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,aAAhB,CAAX,CAEA,GAAiB,IAAb,GAAAH,CAAQ,EAAa,QAAOA,CAAP,UAArB,EAA0E,EAApB,GAAAA,CAAQ,CAACI,IAAT,EAA1D,CAAkF,CAE9EQ,CAAgB,CAAGZ,CAAQ,CAACI,IAAT,EACtB,CAHD,IAGO,CACHQ,CAAgB,CAAG,EACtB,CAEDZ,CAAQ,CAAGzN,CAAC,CAACuN,CAAD,CAAD,CAAWK,IAAX,CAAgB,WAAhB,CAAX,CAEAU,CAAc,CAAGb,CAAQ,CAACI,IAAT,EAAjB,CAGA1D,CAAmB,CAAC+D,CAAD,CAAUC,CAAV,CAAqBC,CAArB,CAAgCC,CAAhC,CAAkDC,CAAlD,CAAnB,CAEAhC,CAAsB,CAAC4B,CAAD,CAAUC,CAAV,CACzB,CAtED,EAuECpD,IAvED,CAuEM,SAASwC,CAAT,CAAkB,CACpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBtM,MAAM,CAACuH,OAAP,CAAegF,GAAf,CAAmBD,CAAnB,CACH,CACDX,CAAiB,CAACH,CAAD,CAAaC,CAAb,CAAiBG,CAAjB,CAAjB,CACA7C,CAAiB,CAAC,sEAAD,CAEpB,CA9ED,CA+EH,CAMD,QAASuF,CAAAA,CAAT,EAAsB,IACd9C,CAAAA,CAAU,CAAGzM,CAAC,CAAC,cAAD,CAAD,CAAkBkG,GAAlB,EADC,CAKlBlG,CAAC,CAACgN,IAAF,CAAO,CACHnG,IAAI,CAAE,KADH,CAEHnB,GAAG,CALU+G,CAAU,CAAG,oCAGvB,CAGHQ,KAAK,GAHF,CAAP,EAKCrI,IALD,CAKM,SAAS2I,CAAT,CAAkB,CAEpB,GAAgB,IAAZ,GAAAA,CAAJ,CAAsB,CAClBtM,MAAM,CAACuH,OAAP,CAAeC,GAAf,CAAmB,8DAAnB,CACH,CAFD,IAEO,CACHxH,MAAM,CAACuH,OAAP,CAAeC,GAAf,CAAmB,mCAAnB,CACH,CACJ,CAZD,EAaCsC,IAbD,CAaM,SAASwC,CAAT,CAAkB,CACpBtM,MAAM,CAACuH,OAAP,CAAeC,GAAf,CAAmB,qEAAnB,EACA,GAAgB,IAAZ,GAAA8E,CAAJ,CAAsB,CAClBtM,MAAM,CAACuH,OAAP,CAAegF,GAAf,CAAmBD,CAAnB,CACH,CACJ,CAlBD,CAmBH,CAqBDvN,CAAC,CAACiB,MAAD,CAAD,CAAUmF,EAAV,CAAa,QAAb,CAAuB,UAAW,CAC9BiB,CAAS,EACZ,CAFD,EAKArH,CAAC,CAACiB,MAAD,CAAD,CAAUmF,EAAV,CAAa,MAAb,CAAqB,UAAW,CAC5BpG,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,CAAe,EAAf,EACAlG,CAAC,CAAC,OAAD,CAAD,CAAWkG,GAAX,CAAe,EAAf,EACAlG,CAAC,CAAC,cAAD,CAAD,CAAkBkG,GAAlB,CAAsB,EAAtB,CACH,CAJD,EAMA2B,CAAW,GAGX7H,CAAC,CAACiB,MAAD,CAAD,CAAUmF,EAAV,CAAa,QAAb,CAAuB,UAAW,CAC9B,GAAgB,IAAZ,GAAAvF,CAAJ,CAAsB,CAClB,GAAII,MAAM,CAACC,GAAP,EAAcD,MAAM,CAACC,GAAP,CAAWG,eAA7B,CAA8C,CAC1CJ,MAAM,CAACC,GAAP,CAAWG,eAAX,CAA2BR,CAA3B,CACH,CAFD,IAEO,CACHI,MAAM,CAACG,SAAP,CAAiBC,eAAjB,CAAiCR,CAAjC,CACH,CACDF,CAAS,CAAG,IAAZ,CACAE,CAAO,CAAG,IACb,CAED,GAAoB,IAAhB,GAAAH,CAAJ,CAA0B,CACtB,GAAIA,CAAW,CAAC6G,SAAhB,CAA2B,CAEvB,OADIC,CAAAA,CAAM,CAAG9G,CAAW,CAAC6G,SAAZ,EACb,CAASE,CAAC,CAAGD,CAAM,CAACE,MAAP,CAAgB,CAA7B,CAAqC,CAAL,EAAAD,CAAhC,CAAwC,EAAEA,CAA1C,CAA6C,CACzCD,CAAM,CAACC,CAAD,CAAN,CAAUE,IAAV,EACH,CACJ,CALD,IAKO,CACHjH,CAAW,CAACiH,IAAZ,EACH,CACD,GAAIhC,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCgC,SAAtC,CAAiD,CAC7CjC,QAAQ,CAACC,cAAT,CAAwB,QAAxB,EAAkCgC,SAAlC,CAA8C,IACjD,CACJ,CAED2H,CAAU,EACb,CA1BD,EA4BAvP,CAAC,CAAC,OAAD,CAAD,CAAWoG,EAAX,CAAc,QAAd,CAAwB,UAAW,CAC/BiB,CAAS,EACZ,CAFD,EAIArH,CAAC,CAAC,OAAD,CAAD,CAAWoG,EAAX,CAAc,QAAd,CAAwB,UAAW,CAC/BiB,CAAS,EACZ,CAFD,EAIArH,CAAC,CAAC,eAAD,CAAD,CAAmBoG,EAAnB,CAAsB,OAAtB,CAA+B,UAAW,CACtCuF,CAAiB,EACpB,CAFD,EAIA3L,CAAC,CAAC,cAAD,CAAD,CAAkBoG,EAAlB,CAAqB,OAArB,CAA8B,UAAW,CACrC8E,CAAgB,EACnB,CAFD,EAIA,CAzEA,UAA4B,CACxBlL,CAAC,CAAC,sBAAD,CAAyB8L,MAAM,CAACnG,QAAhC,CAAD,CAA2C6J,MAA3C,GACAxP,CAAC,CAAC,wBAAD,CAA2B8L,MAAM,CAACnG,QAAlC,CAAD,CAA6C6J,MAA7C,GACAxP,CAAC,CAAC,iBAAD,CAAoB8L,MAAM,CAACnG,QAA3B,CAAD,CAAsC6J,MAAtC,GACAxP,CAAC,CAAC,sBAAD,CAAyB8L,MAAM,CAACnG,QAAhC,CAAD,CAA2C6J,MAA3C,GACAxP,CAAC,CAAC,qBAAD,CAAwB8L,MAAM,CAACnG,QAA/B,CAAD,CAA0C6J,MAA1C,GACAxP,CAAC,CAAC,yBAAD,CAA4B8L,MAAM,CAACnG,QAAnC,CAAD,CAA8C6J,MAA9C,GACAxP,CAAC,CAAC,kBAAD,CAAqB8L,MAAM,CAACnG,QAA5B,CAAD,CAAuC6J,MAAvC,GACAxP,CAAC,CAAC,mBAAD,CAAsB8L,MAAM,CAACnG,QAA7B,CAAD,CAAwC6J,MAAxC,GACAxP,CAAC,CAAC,qBAAD,CAAwB8L,MAAM,CAACnG,QAA/B,CAAD,CAA0C6J,MAA1C,GACAxP,CAAC,CAAC,yBAAD,CAA4B8L,MAAM,CAACnG,QAAnC,CAAD,CAA8C6J,MAA9C,GACAxP,CAAC,CAAC,0BAAD,CAA6B8L,MAAM,CAACnG,QAApC,CAAD,CAA+C6J,MAA/C,EACH,CA6DD,IAEAzK,CAAmB,GAEnBC,CAAkB,EACrB,CAzmDE,CA2mDV,CA7mDK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Recorder Script used in Atto sub-plugin.\n *\n * @package   atto_yukaltura\n * @copyright (C) 2019-2021 Yamaguchi University (gh-cc@mlex.cc.yamaguchi-u.ac.jp)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module atto_yukaltura/attorecorder\n */\n\ndefine(['jquery'], function($) {\n\n    return {\n        /**\n         * Initial function.\n         * @access public\n         */\n        init: function() {\n\n            var fileSize = 0;\n            var sizeResult = false;\n            var fileType = \"\";\n\n            var uploadFileType = \"\";\n            var naturalWidth = 0;\n            var naturalHeight = 0;\n\n            var defaultWidth = 400;\n            var defaultHeight = 300;\n\n            var localStream = null;\n            var videoBlob = null;\n            var videoFilename = \"\";\n            var blobUrl = null;\n            var recorder = null;\n            var constraints = null;\n\n            var createObjectURL = window.URL && window.URL.createObjectURL\n                    ? function(file) {\n                        return window.URL.createObjectURL(file);\n                    }\n                    : window.webkitURL && window.webkitURL.createObjectURL\n                        ? function(file) {\n                            return window.webkitURL.createObjectURL(file);\n                        }\n                        : undefined;\n\n            var revokeObjectURL = window.URL && window.URL.revokeObjectURL\n                    ? function(file) {\n                        return window.URL.revokeObjectURL(file);\n                    }\n                    : window.webkitURL && window.webkitURL.revokeObjectURL\n                        ? function(file) {\n                            return window.webkitURL.revokeObjectURL(file);\n                        }\n                        : undefined;\n\n            var MEDIA_TYPE = {\n                VIDEO: 1,\n                IMAGE: 2,\n                AUDIO: 5\n            };\n\n            var AUTO_FINALIZE = {\n                TRUE: 1,\n                FALSE: 0,\n                NULL: -1\n            };\n\n            var ENTRY_STATUS = {\n                ENTRY_IMPORTING: -2,\n                ENTRY_CONVERTING: -1,\n                ENTRY_IMPORT: 0,\n                ENTRY_PRECONVERT: 1,\n                ENTRY_READY: 2,\n                ENTRY_DELETED: 3,\n                ENTRY_PENDING: 4,\n                ENTRY_MODERATE: 5,\n                ENTRY_BLOCKED: 6,\n                ENTRY_NO_CONTENT: 7\n            };\n\n            var UPLOAD_TOKEN_STATUS = {\n                PENDING: 0,\n                PARTIAL_UPLOAD: 1,\n                FULL_UPLOAD: 2,\n                CLOSED: 3,\n                TIMED_OUT: 4,\n                DELETED: 5\n            };\n\n            /**\n             * This function retrieve whether web browser is the Internet Explorer.\n             * @access public\n             * @return {bool} - true if web browser is the IE, otherwise false.\n             */\n            function isIE() {\n                var ua = navigator.userAgent.toLowerCase();\n                var ver = navigator.appVersion.toLowerCase();\n\n                // Case of IE(not 11).\n                var isMsIE = (ua.indexOf('msie') > -1) && (ua.indexOf('opera') == -1);\n                // Case of IE6.\n                var isIE6 = isMsIE && (ver.indexOf('msie 6.') > -1);\n                // Case of IE7.\n                var isIE7 = isMsIE && (ver.indexOf('msie 7.') > -1);\n                // Cae of IE8.\n                var isIE8 = isMsIE && (ver.indexOf('msie 8.') > -1);\n                // Case of IE9.\n                var isIE9 = isMsIE && (ver.indexOf('msie 9.') > -1);\n                // Case of IE10.\n                var isIE10 = isMsIE && (ver.indexOf('msie 10.') > -1);\n                // Case of IE11.\n                var isIE11 = (ua.indexOf('trident/7') > -1);\n\n                return isMsIE || isIE6 || isIE7 || isIE8 || isIE9 || isIE10 || isIE11;\n            }\n\n            /**\n             * This function retrieve whether we browser is the Edge.\n             * @access public\n             * @return {bool} - true if web browser is the Edge, otherwise false.\n             */\n            function isEdge() {\n                var ua = navigator.userAgent.toLowerCase();\n\n                // Case of Edge.\n                var isMsEdge = (ua.indexOf('edge') > -1);\n                // Case of Google Chrome.\n                var isChrome = (ua.indexOf('chrome') > -1) && (ua.indexOf('edge') == -1);\n                // Case of Moziila Firefox.\n                var isFirefox = (ua.indexOf('firefox') > -1);\n                // Case of Safari.\n                var isSafari = (ua.indexOf('safari') > -1) && (ua.indexOf('chrome') == -1);\n                // Case of Opera.\n                var isOpera = (ua.indexOf('opera') > -1);\n\n                return isMsEdge === true && isChrome === false && isFirefox === false && isSafari === false && isOpera === false;\n            }\n\n            /**\n             * This function retrieve whether web browser is unsupported.\n             * @access public\n             * @return {bool} - true if web browser is unsupported, otherwise false.\n             */\n            function checkUnsupportedBrowser() {\n\n                if (isIE() || isEdge()) {\n                    var browser = \"\";\n                    if (isIE()) {\n                        browser = \"Internet Explorer\";\n                    } else {\n                        browser = \"Edge\";\n                    }\n\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('unsupported_browser', 'local_yumymedia', browser);\n                        $.when(message).done(function(localizedString) {\n                            printInitialErrorMessage(localizedString);\n                        });\n                    });\n\n                    disableInsertButton();\n                    enableCancelButton();\n\n                    return true;\n                }\n                return false;\n            }\n\n            /**\n             * This function retrieve os type.\n             * @return {string} - os type.\n             */\n            function getOperatingSystem() {\n                var os;\n                var ua = navigator.userAgent;\n\n                if (ua.match(/iPhone|iPad|iPod/)) {\n                    os = \"iOS\";\n                } else if (ua.match(/Android|android/)) {\n                    os = \"Android\";\n                } else if (ua.match(/Linux|linux/)) {\n                    os = \"Linux\";\n                } else if (ua.match(/Win(dows)/)) {\n                    os = \"Windows\";\n                } else if (ua.match(/Mac|PPC/)) {\n                    os = \"Mac OS\";\n                } else if (ua.match(/CrOS/)) {\n                    os = \"Chrome OS\";\n                } else {\n                    os = \"Other\";\n                }\n\n                return os;\n            }\n\n            /**\n             * This function retrieve whether os is unsupported.\n             * @access public\n             * @return {bool} - true if os is unsupported, otherwise false.\n             */\n            function checkUnsupportedOS() {\n\n                var os = getOperatingSystem();\n\n                if (os == \"iOS\" || os == \"Android\") {\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('unsupported_os', 'local_yumymedia', os);\n                        $.when(message).done(function(localizedString) {\n                            printInitialErrorMessage(localizedString);\n                        });\n                    });\n\n                    disableInsertButton();\n                    enableCancelButton();\n\n                    return true;\n                }\n                return false;\n            }\n\n            /**\n             * This function checks scheme of URL.\n             * @return {bool} - If scheme is https, returns true. Otherwise, returns false.\n             */\n            function isHttps() {\n                var str = window.location.protocol;\n                if (str.indexOf('https') != -1) {\n                    return true;\n                }\n                return false;\n            }\n\n            /**\n             * This function print initial error message.\n             * @access public\n             * @param {string} message - error message.\n             */\n            function printInitialErrorMessage(message) {\n                var str = \"\";\n                str = \"<p><font color=\\\"red\\\">\" + message + \"</font></p>\";\n                $(\"#upload_info\").html(str);\n\n                disableInsertButton();\n                enableCancelButton();\n            }\n\n            /**\n             * This function print a video player for playing.\n             * @access public\n             * @param {string} url - url of media.\n             */\n            function setPlayingPlayer(url) {\n                var str = \"<video id=\\\"webcam\\\" width=\\\"\" + defaultWidth + \"\\\" height=\\\"\" + defaultHeight + \"\\\" \";\n                str = str + \"src=\\\"\" + url + \"\\\" autoplay=\\\"false\\\" oncontextmenu=\\\"return false;\\\" controls></video>\";\n                $(\"#videospan\").html(str);\n                document.getElementById(\"webcam\").pause();\n                document.getElementById(\"webcam\").currentTime = 0;\n            }\n\n            /**\n             * This function print a video player for preview.\n             * @access public\n             * @param {string} url - url of media.\n             */\n            function setPreviewPlayer(url) {\n                var str = \"<video id=\\\"webcam\\\" width=\\\"\" + defaultWidth + \"\\\" height=\\\"\" + defaultHeight + \"\\\" \";\n                str = str + \"autoplay=\\\"0\\\" muted oncontextmenu=\\\"return false;\\\"></video>\";\n                $(\"#videospan\").html(str);\n                $(\"#webcam\").attr(\"src\", url);\n            }\n\n            /**\n             * This function start video recording by webcamera.\n             * @access public\n             */\n            function startRecording() {\n                $(\"#recstop\").attr(\"src\", $(\"#stopurl\").val());\n                $(\"#recstop\").off(\"click\");\n\n                $(\"#recstop\").on(\"click\", function() {\n                    stopRecording();\n                });\n\n                $(\"#leftspan\").css(\"display\", \"inline\");\n                $(\"#webcam\").volume = 0.0;\n                recorder.start();\n\n                require(['core/str'], function(str) {\n                    var message = str.get_string('now_recording', 'local_yumymedia', null);\n                    $.when(message).done(function(localizedString) {\n                        $(\"#status\").html(\"<font color=\\\"red\\\">\" + localizedString + \"</font>\");\n                    });\n                });\n            }\n\n            /**\n             * This function stop video recording.\n             * @access public\n             */\n            function stopRecording() {\n                recorder.ondataavailable = function(evt) {\n                    videoBlob = new Blob([evt.data], {type: evt.data.type});\n                    if (window.URL && window.URL.createObjectURL) {\n                        blobUrl = window.URL.createObjectURL(videoBlob);\n                    } else {\n                        blobUrl = window.webkitURL.createObjectURL(videoBlob);\n                    }\n                    setPlayingPlayer(blobUrl);\n                    fileSize = videoBlob.size;\n                    var sizeStr = \"\";\n                    var dividedSize = 0;\n\n                    if (fileSize > 1024 * 1024 * 1024) { // When file size exceeds 1GB.\n                        dividedSize = fileSize / (1024 * 1024 * 1024);\n                        sizeStr = dividedSize.toFixed(2) + \" G\";\n                    } else if (fileSize > 1024 * 1024) { // When file size exceeds 1MB.\n                        dividedSize = fileSize / (1024 * 1024);\n                        sizeStr = dividedSize.toFixed(2) + \" M\";\n                    } else if (fileSize > 1024) { // When file size exceeds 1kB.\n                        dividedSize = fileSize / 1024;\n                        sizeStr = dividedSize.toFixed(2) + \" k\";\n                    } else { // When file size under 1kB.\n                        sizeStr = fileSize + \" \";\n                    }\n\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('video_preview', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            localizedString = \"<font color=\\\"green\\\">\" + localizedString + \"(\" + videoBlob.type + \", \";\n                            localizedString = localizedString + sizeStr + \"B).</font>\";\n                            $(\"#status\").html(localizedString);\n                        });\n                    });\n\n                    fileType = checkFileType(videoBlob.type);\n                    sizeResult = checkFileSize();\n                    if (sizeResult === false) {\n                        require(['core/str'], function(str) {\n                            var message = str.get_string('wrong_filesize', 'local_yumymedia', null);\n                            $.when(message).done(function(localizedString) {\n                                window.alert(localizedString);\n                            });\n                        });\n\n                        uploadFileType = fileType;\n                        naturalWidth = 0;\n                        naturalHeight = 0;\n                    }\n\n                    checkForm();\n                    videoFilename = $(\"#filename\").val() + \".\" + getFileExtension(videoBlob.type);\n                };\n\n                if (localStream.getTracks !== undefined && localStream.getTracks !== null) {\n                    var tracks = localStream.getTracks();\n                    for (var i = tracks.length - 1; i >= 0; --i) {\n                        tracks[i].stop();\n                    }\n                    if (document.getElementById(\"webcam\").srcObject !== undefined) {\n                        document.getElementById(\"webcam\").srcObject = null;\n                    }\n                }\n\n                recorder.stop();\n\n                $(\"#leftspan\").css(\"display\", \"none\");\n                $(\"#rightspan\").css(\"display\", \"inline\");\n\n                $(\"#remove\").on(\"click\", function() {\n                    removeVideo();\n                });\n            }\n\n            /**\n             * This function remove recorded video.\n             * @access public\n             */\n            function removeVideo() {\n                if (!isHttps()) {\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('require_https', 'local_yumymedia');\n                        $.when(message).done(function(localizedString) {\n                            printInitialErrorMessage(localizedString);\n                        });\n                    });\n                    return;\n                }\n\n                // Print error message and return true if web browser is unsupported.\n                if (checkUnsupportedBrowser() || checkUnsupportedOS()) {\n                    return;\n                }\n\n                navigator.mediaDevices = navigator.mediaDevices || ((navigator.mozGetUserMedia || navigator.webkitGetUserMedia) ? {\n                    getUserMedia: function(c) {\n                        return function(y, n) {\n                            (navigator.mozGetUserMedia || navigator.webkitGetUserMedia).call(navigator, c, y, n);\n                        };\n                    }\n                } : null);\n\n                try {\n                    if (navigator.mediaDevices === null || navigator.mediaDevices === undefined ||\n                        MediaRecorder === null || MediaRecorder === undefined) {\n                        require(['core/str'], function(str) {\n                            var message = str.get_string('disable_webrtc', 'local_yumymedia', null);\n                            $.when(message).done(function(localizedString) {\n                                printInitialErrorMessage(localizedString);\n                            });\n                        });\n                        return;\n                    }\n\n                    if (createObjectURL === null || createObjectURL === undefined ||\n                        revokeObjectURL === null || revokeObjectURL === undefined) {\n                        require(['core/str'], function(str) {\n                            var message = str.get_string('disable_objecturl', 'local_yumymedia', null);\n                            $.when(message).done(function(localizedString) {\n                                printInitialErrorMessage(localizedString);\n                            });\n                        });\n                        return;\n                    }\n                } catch (err) {\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('disable_webrtc', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            printInitialErrorMessage(localizedString);\n                        });\n                    });\n                    window.console.log(err);\n                    return;\n                }\n\n                setPreviewPlayer(null);\n\n                if (blobUrl !== null) {\n                    if (window.URL && window.URL.revokeObjectURL) {\n                        window.URL.revokeObjectURL(blobUrl);\n                    } else {\n                        window.webkitURL.revokeObjectURL(blobUrl);\n                    }\n                    blobUrl = null;\n                    videoBlob = null;\n                }\n\n                if (localStream !== null) {\n                    if (localStream.getTracks !== undefined || localStream.getTracks !== null) {\n                        var tracks = localStream.getTracks();\n                        for (var i = tracks.length - 1; i >= 0; --i) {\n                            tracks[i].stop();\n                        }\n                        if (document.getElementById(\"webcam\").srcObject) {\n                            document.getElementById(\"webcam\").srcObject = null;\n                        }\n\n                    } else {\n                        localStream.stop();\n                    }\n                }\n\n                fileSize = 0;\n                sizeResult = false;\n                fileType = \"\";\n\n                $(\"#recstop\").off(\"click\");\n                $(\"#remove\").off(\"click\");\n                $(\"#webcam\").off(\"ondataavailable\");\n\n                var mimeOption = \"\";\n\n                var WebcamRecorder = MediaSource || MediaRecorder;\n\n                // Selection of video codec.\n                if (WebcamRecorder.isTypeSupported(\"video/webm\")) {\n                    mimeOption = \"video/webm\";\n                } else if (WebcamRecorder.isTypeSupported(\"video/mp4\")) {\n                    mimeOption = \"video/mp4\";\n                } else if (WebcamRecorder.isTypeSupported(\"video/webm;codecs=vp8,opus\")) {\n                    mimeOption = \"video/webm; codecs=vp8,opus\";\n                } else if (WebcamRecorder.isTypeSupported(\"video/webm;codecs=vp9,opus\")) {\n                    mimeOption = \"video/webm; codecs=vp9,opus\";\n                } else if (WebcamRecorder.isTypeSupported(\"video/webm;codecs=vp8\")) {\n                    mimeOption = \"video/webm; codecs=vp8\";\n                } else {\n                    mimeOption = \"video/webm; codecs=vp9\";\n                }\n\n                // Prefer camera resolution nearest to 1280x720.\n                constraints = {\n                    audioBitsPerSecond: 128000,\n                    videoBitsPerSecond: 1500000,\n                    mimeType: mimeOption,\n                    audio: {\n                        echoCancellation: false\n                    },\n                    video: {\n                        \"mandatory\": {\n                            minWidth: 320,\n                            minHeight: 240,\n                            maxWidth: 1280,\n                            maxHeight: 720,\n                            minFrameRate: 5,\n                            maxFrameRate: 15\n                        },\n                        \"optional\": [{\"facingMode\": \"user\"}]\n                    }\n                };\n\n                var p = navigator.mediaDevices.getUserMedia(constraints);\n\n                p.then(function(stream) {\n                    localStream = stream;\n                    var video = document.getElementById(\"webcam\");\n                    if (video.srcObject !== undefined) {\n                        video.srcObject = localStream;\n                        video.play();\n                    } else {\n                        if (window.URL && window.URL.createObjectURL) {\n                            blobUrl = window.URL.createObjectURL(blobUrl);\n                        } else {\n                            blobUrl = window.webkitURL.createObjectURL(blobUrl);\n                        }\n                        $(\"#webcam\").attr(\"src\", blobUrl);\n                    }\n                    window.console.log(localStream);\n\n                    if (MediaSource !== null || MediaSource !== undefined) {\n                        recorder = new MediaRecorder(localStream);\n                    } else {\n                        recorder = new MediaRecorder(localStream, constraints);\n                    }\n\n                    $(\"#recstop\").attr(\"src\", $(\"#recurl\").val());\n                    $(\"#recstop\").on(\"click\", function() {\n                        startRecording();\n                    });\n                    $(\"#leftspan\").css(\"display\", \"inline\");\n                    $(\"#rightspan\").css(\"display\", \"none\");\n\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('camera_preview', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            $(\"#status\").html(localizedString);\n                        });\n                    });\n\n                    checkForm();\n                    return 0;\n                })\n                .catch(function(err) {\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('unsupported_camera', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            printInitialErrorMessage(localizedString);\n                        });\n                    });\n\n                    window.console.log(err);\n                    return -1;\n                });\n            }\n\n            /**\n             * This function checks file size.\n             * @access public\n             * @return {bool} - The file can upload?\n             */\n            function checkFileSize() {\n                if (fileSize <= 0) {\n                    return false;\n                }\n                if (fileSize > 2000000000) {\n                    return false;\n                }\n                return true;\n            }\n\n            /**\n             * This function checks file type.\n             * @access public\n             * @param {string} fileType - file type of selected media.\n             * @return {string} - media type string for kaltura server.\n             */\n            function checkFileType(fileType) {\n                if (fileType.indexOf(\"video/avi\") != -1 || fileType.indexOf(\"video/x-msvideo\") != -1 ||\n                    fileType.indexOf(\"video/mpeg\") != -1 || fileType.indexOf(\"video/mpg\") != -1 ||\n                    fileType.indexOf(\"video/mp4\") != -1 || fileType.indexOf(\"video/ogg\") ||\n                    fileType.indexOf(\"video/quicktime\") != -1 || fileType.indexOf(\"video/VP8\") != -1 ||\n                    fileType.indexOf(\"video/x-flv\") != -1 || fileType.indexOf(\"video/x-f4v\") != -1 ||\n                    fileType.indexOf(\"video/x-matroska\") != -1 ||\n                    fileType.indexOf(\"video/x-ms-wmv\") != -1 || fileType.indexOf(\"video/webm\") != -1) {\n                    return \"video\";\n                }\n\n                if (fileType.indexOf(\"audio/ac3\") != -1 || fileType.indexOf(\"audio/ogg\") != -1 ||\n                    fileType.indexOf(\"audio/mpeg\") != -1 || fileType.indexOf(\"audio/mp4\") != -1 ||\n                    fileType.indexOf(\"audio/mp3\") != -1 ||\n                    fileType.indexOf(\"audio/wav\") != -1 || fileType.indexOf(\"audio/x-ms-wma\") != -1) {\n                    return \"audio\";\n                }\n\n                if (fileType.indexOf(\"image/gif\") != -1 || fileType.indexOf(\"image/jpeg\") != -1 ||\n                    fileType.indexOf(\"image/png\") != -1 || fileType.indexOf(\"image/tiff\") != -1) {\n                    return \"image\";\n                }\n\n                return \"N/A\";\n            }\n\n            /**\n             * This function return file extension string.\n             * @access public\n             * @param {string} fileType - file type of selected media.\n             * @return {string} - file extension of selected media.\n             */\n            function getFileExtension(fileType) {\n                if (fileType.indexOf(\"video/avi\") != -1 || fileType.indexOf(\"video/x-msvideo\") != -1) {\n                    return \"avi\";\n                }\n                if (fileType.indexOf(\"video/mpeg\") != -1 || fileType.indexOf(\"video/mpg\") != -1 ||\n                    fileType.indexOf(\"audio/mpeg\") != -1 || fileType.indexOf(\"audio/mpg\") != -1) {\n                    return \"mpeg\";\n                }\n                if (fileType.indexOf(\"video/mp4\") != -1 || fileType.indexOf(\"video/m4v\") != -1 ||\n                    fileType.indexOf(\"audio/mp4\") != -1) {\n                    return \"mp4\";\n                }\n                if (fileType.indexOf(\"video/ogg\") != -1) {\n                    return \"ogg\";\n                }\n                if (fileType.indexOf(\"video/quicktime\") != -1) {\n                    return \"mov\";\n                }\n                if (fileType.indexOf(\"video/VP8\") != -1 || fileType.indexOf(\"video/VP9\") != -1 ||\n                    fileType.indexOf(\"video/vp8\") != -1 || fileType.indexOf(\"video/vp9\") != -1 ||\n                    fileType.indexOf(\"video/webm\") != -1) {\n                    return \"webm\";\n                }\n                if (fileType.indexOf(\"video/x-flv\") != -1 || fileType.indexOf(\"video/x-f4v\") != -1) {\n                    return \"flv\";\n                }\n                if (fileType.indexOf(\"video/x-matroska\") != -1) {\n                    return \"mkv\";\n                }\n                if (fileType.indexOf(\"video/x-ms-wmv\") != -1) {\n                    return \"wmv\";\n                }\n\n                if (fileType.indexOf(\"audio/ac3\") != -1) {\n                    return \"ac3\";\n                }\n                if (fileType.indexOf(\"audio/ogg\") != -1) {\n                    return \"ogg\";\n                }\n                if (fileType.indexOf(\"audio/wav\") != -1) {\n                    return \"wav\";\n                }\n                if (fileType.indexOf(\"audio/x-ms-wma\") != -1) {\n                    return \"wma\";\n                }\n\n                if (fileType.indexOf(\"image/gif\") != -1) {\n                    return \"gif\";\n                }\n                if (fileType.indexOf(\"image/jpeg\") != -1) {\n                    return \"jpg\";\n                }\n                if (fileType.indexOf(\"image/png\") != -1) {\n                    return \"png\";\n                }\n                if (fileType.indexOf(\"image/tiff\") != -1) {\n                    return \"tiff\";\n                }\n\n                return \"webm\";\n            }\n\n            /**\n             * This function checks metadata.\n             * @access public\n             */\n            function checkForm() {\n                if (blobUrl === null ||\n                    videoBlob === null ||\n                    videoBlob.size === 0 ||\n                    sizeResult === false ||\n                    $(\"#name\").val() === \"\" ||\n                    $(\"#tags\").val() === \"\" ||\n                    fileType === \"\" ||\n                    fileType === \"N/A\") {\n                    // Dsiable upload button.\n                    $(\"#entry_submit\").prop(\"disabled\", true);\n                    $(\"#entry\").val(\"\");\n                } else {\n                    // Enable upload button.\n                    $(\"#entry_submit\").prop(\"disabled\", false);\n                }\n            }\n\n            /**\n             * This function prints error message.\n             * @access public\n             * @param {string} errorMessage - string of error message.\n             */\n            function printErrorMessage(errorMessage) {\n                $(\"#upload_info\").html(\"\");\n                $(\"#upload_info\").append(\"<font color=\\\"red\\\">\" + errorMessage + \"</font><br>\");\n\n                disableInsertButton();\n                enableCancelButton();\n            }\n\n            /**\n             * This function prints success message.\n             * @access public\n             * @param {string} id - id of media entry.\n             * @param {string} name - name of media entry.\n             * @param {string} tags - tags of media entry.\n             * @param {string} description - description of media entry.\n             * @param {string} creatorId - username of creator.\n             */\n            function printSuccessMessage(id, name, tags, description, creatorId) {\n\n                require(['core/str', 'core/notification'], function(str, notification) {\n                    var strings = [\n                        {key: 'upload_success', component: 'local_yumymedia'},\n                        {key: 'entryid_header', component: 'local_yumymedia'},\n                        {key: 'name_header', component: 'local_yumymedia'},\n                        {key: 'tags_header', component: 'local_yumymedia'},\n                        {key: 'desc_header', component: 'local_yumymedia'},\n                        {key: 'creatorid_header', component: 'local_yumymedia'},\n                        {key: 'insert_media', component: 'atto_yukaltura'}\n                    ];\n                    str.get_strings(strings).then(function(results) {\n                        var output = '<h3>' + results[0] + '</h3>';\n                        output += '<table border=\"2\" cellpadding=\"5\">';\n                        output += '<tr><td>' + results[1] + '</td><td>' + id + '</td></tr>';\n                        output += '<tr><td>' + results[2] + '</td><td>' + name + '</td></tr>';\n                        output += '<tr><td>' + results[3] + '</td><td>' + tags + '</td></tr>';\n                        output += '<tr><td>' + results[4] + '</td><td>' + description + '</td></tr>';\n                        output += '<tr><td>' + results[5] + '</td><td>' + creatorId + '</td></tr>';\n                        output += '</table>';\n                        output += '<br>';\n                        output += '<p><font color=\"red\">' + results[6] + '</font></p>';\n                        $(\"#upload_info\").html(output);\n                        return 0;\n                    }).fail(notification.exception);\n                });\n\n                // Enable dialogue buttons.\n                enableInsertButton();\n                enableCancelButton();\n            }\n\n            /**\n             * This function is callback for reset button.\n             * @access public\n             */\n            function handleResetClick() {\n                $(\"#file_info\").html(\"\");\n                $(\"#type\").val(\"\");\n\n                uploadFileType = \"\";\n                naturalWidth = 0;\n                naturalHeight = 0;\n\n                disableInsertButton();\n                enableCancelButton();\n            }\n\n            /**\n             * This function checks name of media.\n             * @access public\n             * @param {string} str - name of media.\n             * @return {bool} - if name is appropriate, return \"true\". Otherwise, return \"false\".\n             */\n            function checkNameString(str) {\n                var regex = /[\"$%&'~^\\\\`/]/;\n                if (regex.test(str) === true) {\n                    return false;\n                } else {\n                    return true;\n                }\n            }\n\n            /**\n             * This function checks tags of media.\n             * @access public\n             * @param {string} str - tagas of media.\n             * @return {bool} - if tags are appropriate, return \"true\". Otherwise, return \"false\".\n             */\n            function checkTagsString(str) {\n                var regex = /[!\"#$%&'~|^\\\\@`()[\\]{}:;+*/=<>?]/;\n                if (regex.test(str) === true) {\n                    return false;\n                } else {\n                    return true;\n                }\n            }\n\n            /**\n             * This function checks metadata of media.\n             * @access public\n             * @return {bool} - if metadata is appropriate, return \"true\". Otherwise, return \"false\".\n             */\n            function checkMetadata() {\n                var nameStr = $(\"#name\").val();\n                var tagsStr = $(\"#tags\").val();\n                var descStr = $(\"#description\").val();\n\n                var flag = true;\n\n                if (checkNameString(nameStr) === false) {\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('wrong_name', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            window.alert(localizedString);\n                        });\n                    });\n                    flag = false;\n                }\n\n                if (checkTagsString(tagsStr) === false) {\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('wrong_tags', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            window.alert(localizedString);\n                        });\n                    });\n                    flag = false;\n                }\n\n                if (checkNameString(descStr) === false) {\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('wrong_desc', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            window.alert(localizedString);\n                        });\n                    });\n                    flag = false;\n                }\n\n                return flag;\n            }\n\n            /**\n             * This function is callback for submit button.\n             * @access public\n             * @return {bool} - if file is uploaded, return true. Otherwise, return false.\n             */\n            function handleSubmitClick() {\n\n                if (checkMetadata() === false) {\n                    return false;\n                }\n\n                if (checkFileSize() === false) {\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('wrong_filesize', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            window.alert(localizedString);\n                        });\n                    });\n                    return false;\n                }\n\n                $(\"#entry_submit\").prop(\"disabled\", true);\n                executeUploadProcess(); // Executes upload.\n\n                return true;\n            }\n\n            /**\n             * This function get hidden parameters.\n             * @access public\n             */\n            function getHiddenParameters() {\n                // Create new element if entry id element is null.\n                if (parent.document.getElementById('yukaltura_select_id') === null ||\n                    parent.document.getElementById('yukaltura_select_id')[0] === null) {\n                    var element = $('body', parent.document);\n\n                    var str = '<input type=\"hidden\" name=\"yukaltura_select_id\" id=\"yukaltura_select_id\" value=\"\">';\n                    element.append(str);\n\n                    str = '<input type=\"hidden\" name=\"yukaltura_select_name\" id=\"yukaltura_select_name\" value=\"\">';\n                    element.append(str);\n\n                    var kalturahost = $('#kalturahost').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_host\" id=\"yukaltura_host\" value=\"';\n                    str = str + kalturahost + '\">';\n                    element.append(str);\n\n                    var partnerid = $('#partnerid').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_partnerid\" id=\"yukaltura_partnerid\" value=\"';\n                    str = str + partnerid + '\">';\n                    element.append(str);\n\n                    var uiconfid = $('#uiconfid').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_uiconfid\" id=\"yukaltura_uiconfid\" value=\"';\n                    str = str + uiconfid + '\">';\n                    element.append(str);\n\n                    var width = $('#player_width').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_width\" id=\"yukaltura_width\" value=\"' + width + '\">';\n                    element.append(str);\n\n                    var height = $('#player_height').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_height\" id=\"yukaltura_height\" value=\"' + height + '\">';\n                    element.append(str);\n\n                    var studio = $('#player_studio').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_playerstudio\" id=\"yukaltura_playerstudio\" value=\"' + studio + '\">';\n                    element.append(str);\n\n                    str = '<input type=\"hidden\" name=\"yukaltura_filetype\" id=\"yukaltura_filetype\" value=\"\">';\n                    element.append(str);\n\n                    str = '<input type=\"hidden\" name=\"yukaltura_naturalwidth\" id=\"yukaltura_naturalwidth\" value=\"\">';\n                    element.append(str);\n\n                    str = '<input type=\"hidden\" name=\"yukaltura_naturalheight\" id=\"yukaltura_naturalheight\" value=\"\">';\n                    element.append(str);\n                }\n            }\n\n            /**\n             * This function update hidden parameters,\n             * @access public\n             * @param {string} id - id of media entry.\n             * @param {string} name - name of media entry.\n             */\n            function updateHiddenParameters(id, name) {\n                if (id !== null && id !== '' &&\n                    parent.document.getElementById('yukaltura_select_id') !== null &&\n                    parent.document.getElementById('yukaltura_select_id')[0] !== null) {\n                    // Set entry id of selectd media.\n                    $('#yukaltura_select_id', parent.document).val(id);\n                    // Set entry name of selected media.\n                    $('#yukaltura_select_name', parent.document).val(name);\n\n                    $('#yukaltura_filetype', parent.document).val(uploadFileType);\n                    $('#yukaltura_naturalwidth', parent.document).val(naturalWidth);\n                    $('#yukaltura_naturalheight', parent.document).val(naturalHeight);\n                }\n            }\n\n            /**\n             * This function enable insert button.\n             * @access public\n             */\n            function enableInsertButton() {\n                // Eable insert button.\n                $('#yukaltura_insert_btn', parent.document).prop(\"disabled\", false);\n                $('#yukaltura_insert_btn', parent.document).css({opacity: \"1.0\"});\n            }\n\n            /**\n             * This function disable insert button.\n             * @access public\n             */\n            function disableInsertButton() {\n                // Disable insert button.\n                $('#yukaltura_insert_btn', parent.document).prop(\"disabled\", true);\n                $('#yukaltura_insert_btn', parent.document).css({opacity: \"0.5\"});\n            }\n\n            /**\n             * This function enable cancel button.\n             * @access public\n             */\n            function enableCancelButton() {\n                // Eable cancel button.\n                $('#yukaltura_cancel_btn', parent.document).prop(\"disabled\", false);\n                $('#yukaltura_cancel_btn', parent.document).css({opacity: \"1.0\"});\n            }\n\n            /**\n             * This function disable cancel button.\n             * @access public\n             */\n            function disableCancelButton() {\n                // Disable cancel button.\n                $('#yukaltura_cancel_btn', parent.document).prop(\"disabled\", true);\n                $('#yukaltura_cancel_btn', parent.document).css({opacity: \"0.5\"});\n            }\n\n            /**\n             * This function executes upload process.\n             * @access public\n             */\n            function executeUploadProcess() {\n                var serverHost = $(\"#kalturahost\").val(); // Get hostname of kaltura server.\n                var ks = $(\"#ks\").val(); // Get session id.\n\n                disableInsertButton();\n                disableCancelButton();\n\n                getHiddenParameters();\n\n                // Create upload token.\n                createUploadToken(serverHost, ks);\n            }\n\n            /**\n             * This function deletes upload token.\n             * @access public\n             * @param {string} serverHost - hostname of kaltura server.\n             * @param {string} ks - session string of kaltura connection.\n             * @param {string} uploadTokenId - token id for uploading.\n             * @return {bool} - if upload token is deleted, return true.\n             */\n            function deleteUploadToken(serverHost, ks, uploadTokenId) {\n                var fd = new FormData();\n                var flag;\n\n                // Set form data.\n                fd.append(\"action\", \"delete\");\n                fd.append(\"ks\", ks);\n                fd.append(\"uploadTokenId\", uploadTokenId);\n\n                // Set transmission data.\n                var postData = {\n                    type: \"POST\",\n                    data: fd,\n                    cache: false,\n                    contentType: false,\n                    scriptCharset: \"utf-8\",\n                    processData: false,\n                    async: true,\n                    dataType: \"xml\"\n                };\n\n                var serviceURL = serverHost + \"/api_v3/service/uploadToken/action/delete\";\n\n                // Transmits a data.\n                $.ajax(\n                    serviceURL, postData\n                )\n                .done(function(xmlData) {\n                    // When response is not XML.\n                    if (xmlData === null) {\n                        flag = false;\n                    }\n                    flag = true;\n                })\n                .fail(function(xmlData) {\n                    flag = false;\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                });\n\n                return flag;\n            }\n\n            /**\n             * This function creates upload token.\n             * @access public\n             * @param {string} serverHost - hostname of kaltura server.\n             * @param {string} ks - session string of kaltura connection.\n             */\n            function createUploadToken(serverHost, ks) {\n                var uploadTokenId;\n                var findData;\n\n                var postData = {\n                    type: \"GET\",\n                    cache: false,\n                    async: true,\n                    contentType: false,\n                    scriptCharset: \"utf-8\",\n                    dataType: \"xml\"\n                };\n\n                var serviceURL = serverHost + \"/api_v3/service/uploadToken/action/add?ks=\" + ks;\n                serviceURL = serviceURL + \"&uploadToken:objectType=KalturaUploadToken\";\n                serviceURL = serviceURL + \"uploadToken:fileName=\" + encodeURI(videoFilename);\n                serviceURL = serviceURL + \"&uploadToken:fileSize=\" + videoBlob.size;\n                serviceURL = serviceURL + \"&uploadToken:autoFinalize=\" + AUTO_FINALIZE.NULL;\n\n                // Transmits data.\n                $.ajax(\n                    serviceURL, postData\n                )\n                .done(function(xmlData) {\n                    // Response is not XML.\n                    if (xmlData === null) {\n                        printErrorMessage(\"Cannot create upload token !<br>(Cannot get a XML response.)\");\n                        return;\n                    }\n\n                    // Get a tag of error code.\n                    findData = $(xmlData).find(\"code\");\n                    // There exists error code.\n                    if (findData !== null && typeof findData !== undefined && findData.text() !== \"\") {\n                        printErrorMessage(\"Cannot create upload token !<br>(\" + findData.text() + \")\");\n                        return;\n                    }\n\n                    findData = $(xmlData).find(\"status\");\n                    // There not exists upload token id.\n                    if (findData === null || typeof findData === undefined || findData.text() === \"\") {\n                        printErrorMessage(\"Cannot create upload token !<br>(Cannot get status of upload token.)\");\n                        return;\n                    }\n\n                    var uploadTokenStatus = findData.text();\n                    if (uploadTokenStatus != UPLOAD_TOKEN_STATUS.PENDING) {\n                        printErrorMessage(\"Cannot create upload token !<br>(UPLOAD_TOKEN_STATUS : \" + uploadTokenStatus + \")\");\n                        return;\n                    }\n\n                    // Get upload token id.\n                    findData = $(xmlData).find(\"id\");\n                    // There not exists upload token id.\n                    if (findData === null || typeof findData === undefined || findData.text() === \"\") {\n                        printErrorMessage(\"Cannot create uplaod token !<br>(Cannot get an uploadTokenId.)\");\n                        return;\n                    }\n                    uploadTokenId = findData.text();\n                    // Entry metadata.\n                    setTimeout(function() {\n                        createMediaEntry(serverHost, ks, uploadTokenId);\n                    }, 50);\n\n                })\n                .fail(function(xmlData) {\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                    printErrorMessage(\"Cannot create upload token !<br>(Cannot connect to kaltura server.)\");\n                });\n            }\n\n            /**\n             * This function creates media entry.\n             * @access public\n             * @param {string} serverHost - hostname of kaltura server.\n             * @param {string} ks - session string of kaltura connecion;\n             * @param {string} uploadTokenId - upload token id.\n             */\n            function createMediaEntry(serverHost, ks, uploadTokenId) {\n                var findData;\n                var entryStatus;\n                var entryId = \"\";\n                var entryName = \"\";\n                var entryTags = \"\";\n                var entryDescription = \"\";\n                var entryCreatorId = \"\";\n\n                var nameStr = $(\"#name\").val();\n                var tagsStr = $(\"#tags\").val();\n                var descStr = $(\"#description\").val();\n                var controlId = $(\"#controlId\").val();\n                var creatorId = $(\"#creatorId\").val();\n\n                nameStr = nameStr.trim();\n                tagsStr = tagsStr.trim();\n                if (descStr !== null) {\n                    descStr = descStr.trim();\n                }\n\n                var fd = new FormData();\n\n                // Creates form data.\n                fd.append(\"action\", \"add\");\n                fd.append(\"ks\", ks);\n                fd.append(\"entry:objectType\", \"KalturaMediaEntry\");\n                fd.append(\"entry:mediaType\", MEDIA_TYPE.VIDEO);\n                fd.append(\"entry:sourceType\", 1);\n                fd.append(\"entry:name\", nameStr);\n                fd.append(\"entry:tags\", tagsStr);\n                if (descStr !== null && descStr !== \"\") {\n                    fd.append(\"entry:description\", descStr);\n                } else {\n                    fd.append(\"entry:description\", \"\");\n                }\n\n                fd.append(\"entry:categories\", $(\"#categories\").val());\n\n                if (controlId !== null && controlId !== \"\") {\n                    fd.append(\"entry:accessControlId\", controlId);\n                }\n\n                fd.append(\"entry:creatorId\", creatorId);\n                fd.append(\"entry:userId\", creatorId);\n\n                // Creates transmission data.\n                var postData = {\n                    type: \"POST\",\n                    data: fd,\n                    cache: false,\n                    async: true,\n                    contentType: false,\n                    scriptCharset: \"utf-8\",\n                    processData: false,\n                    dataType: \"xml\"\n                };\n\n                var serviceURL = serverHost + \"/api_v3/service/media/action/add\";\n\n                // Transmits data.\n                $.ajax(\n                    serviceURL, postData\n                )\n                .done(function(xmlData) {\n                    // Response is not XML.\n                    if (xmlData === null || typeof xmlData === undefined) {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot create media entry !<br>(Cannot get a XML response.)\");\n                        return;\n                    }\n\n                    // Get a tag of error code.\n                    findData = $(xmlData).find(\"code\");\n                    // There exists an error code.\n                    if (findData !== null && typeof findData !== undefined && findData.text() !== \"\") {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot create media entry !<br>(\" + findData.text() + \")\");\n                        return;\n                    }\n\n                    // Get a tag of status.\n                    findData = $(xmlData).find(\"status\");\n                    // There not exists a tag of status.\n                    if (findData === null || typeof findData === undefined || findData.text() === \"\") {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot create media entyry !<br>(Cannot get a mediaEntryStatus.)\");\n                        return;\n                    }\n\n                    // Get a value of status.\n                    entryStatus = findData.text();\n                    // When uploading of metadata failed.\n                    if (entryStatus != ENTRY_STATUS.ENTRY_NO_CONTENT) {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot create media entry!<br>(mediaEntryStatus: \" + entryStatus + \")\");\n                        return;\n                    }\n\n                    // Get a tag of entry id.\n                    findData = $(xmlData).find(\"id\");\n                    // Get a value of entry id.\n                    entryId = findData.text();\n                    // Get a tag of name.\n                    findData = $(xmlData).find(\"name\");\n                    // Get a value of name.\n                    entryName = findData.text();\n                    // Get a tag of tags.\n                    findData = $(xmlData).find(\"tags\");\n                    // Get a value of tags.\n                    entryTags = findData.text();\n                    // Get a tag of description.\n                    findData = $(xmlData).find(\"description\");\n                    // There exists description.\n                    if (findData !== null && typeof findData !== undefined && findData.text() !== \"\") {\n                        // Get a value of description.\n                        entryDescription = findData.text();\n                    } else {\n                        entryDescription = \"\";\n                    }\n                    // Get a tago of creator id.\n                    findData = $(xmlData).find(\"creatorId\");\n                    // Get a value of creator id.\n                    entryCreatorId = findData.text();\n\n                    if (entryId === null || entryId === \"\" || entryName === null || entryName === \"\" ||\n                        entryTags === null || entryTags === \"\" || entryCreatorId === null || entryCreatorId === \"\" ||\n                        descStr !== \"\" && (entryDescription === null || entryDescription === \"\")) {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"There exists wrong information(s) <br>\");\n                        return;\n                    }\n\n                    // Associate uploaded file with media entry.\n                    setTimeout(function() {\n                        uploadMediaFile(serverHost, ks, uploadTokenId, entryId);\n                    }, 50);\n\n                })\n                .fail(function(xmlData) {\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                    deleteUploadToken(serverHost, ks, uploadTokenId);\n                    printErrorMessage(\"Cannot create media entry !<br>(Cannot connect to kaltura server.)\");\n                    return;\n                });\n            }\n\n            /**\n             * This function uploads media file.\n             * @access public\n             * @param {string} serverHost - hostname of kaltura server.\n             * @param {string} ks - session string of kaltura connection.\n             * @param {string} uploadTokenId - upload token id.\n             * @param {string} entryId - id of media entry.\n             */\n            function uploadMediaFile(serverHost, ks, uploadTokenId, entryId) {\n                var findData;\n                var fd = new FormData();\n\n                $(\"#upload_info\").html(\"\");\n\n                require(['core/str'], function(str) {\n                    var message = str.get_string('recorder_uploading', 'local_yumymedia', null);\n                    $.when(message).done(function(localizedString) {\n                        $(\"#upload_info\").append(localizedString + \"<br>\");\n                    });\n                });\n\n                require(['core/str'], function(str) {\n                    var message = str.get_string('progress', 'local_yumymedia', null);\n                    $.when(message).done(function(localizedString) {\n                        var str = \"<p>\" + localizedString;\n                        str = str + \": <span id=\\\"pvalue\\\" style=\\\"color:#00b200\\\">0.00</span> %</p>\";\n                        $(\"#upload_info\").append(str);\n                    });\n                });\n\n                // Creates form data.\n                fd.append(\"action\", \"upload\");\n                fd.append(\"ks\", ks);\n                fd.append(\"uploadTokenId\", uploadTokenId);\n                fd.append(\"fileData\", videoBlob, encodeURI(videoFilename), videoBlob.size);\n                fd.append(\"resume\", false);\n                fd.append(\"finalChunk\", true);\n                fd.append(\"resumeAt\", 0);\n\n                // Creates tnramission data.\n                var postData = {\n                    type: \"POST\",\n                    data: fd,\n                    cache: false,\n                    async: true,\n                    contentType: false,\n                    scriptCharset: \"utf-8\",\n                    processData: false,\n                    dataType: \"xml\",\n                    xhr: function() {\n                        var XHR = $.ajaxSettings.xhr();\n                        if (XHR.upload) {\n                            XHR.upload.addEventListener(\"progress\", function(e) {\n                                var newValue = parseInt(e.loaded / e.total * 100);\n                                $(\"#pvalue\").html(parseInt(newValue));\n                            }, false);\n                        }\n                        return XHR;\n                    }\n                };\n\n                var serviceURL = serverHost + \"/api_v3/service/uploadToken/action/upload\";\n\n                // Transmits data.\n                $.ajax(\n                    serviceURL, postData\n                )\n                .done(function(xmlData) {\n                    // Response is not XML.\n                    if (xmlData === null) {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot upload the video !<br>(Cannot get a XML response.)\");\n                        return;\n                    }\n\n                    // Get a tag of error code.\n                    findData = $(xmlData).find(\"code\");\n                    // There exists error code.\n                    if (findData !== null && typeof findData !== undefined && findData.text() !== \"\") {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot upload the video !<br>(\" + findData.text() + \")\");\n                        return;\n                    }\n\n                    // Get upload token id.\n                    findData = $(xmlData).find(\"status\");\n                    // There not exists upload token id.\n                    if (findData === null || typeof findData === undefined || findData.text() === \"\") {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot upload the video !<br>(Cannot get an uploadTokenStatus.)\");\n                        return;\n                    }\n\n                    var uploadTokenStatus = findData.text();\n                    if (uploadTokenStatus != UPLOAD_TOKEN_STATUS.FULL_UPLOAD &&\n                        uploadTokenStatus != UPLOAD_TOKEN_STATUS.PARTIAL_UPLOAD) {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot upload the video !<br>(UPLOAD_TOKEN_STATUS : \" + uploadTokenStatus + \")\");\n                        return;\n                    } else {\n                        window.console.log(\"File chunk have been transmitted.\");\n                    }\n\n                    require(['core/str'], function(str) {\n                        var message = str.get_string('attach_file', 'local_yumymedia', null);\n                        $.when(message).done(function(localizedString) {\n                            $(\"#upload_info\").append(localizedString + \"<br>\");\n                        });\n                    });\n\n                    // Create media entry.\n                    setTimeout(function() {\n                        attachUploadedFile(serverHost, ks, uploadTokenId, entryId);\n                    }, 1000);\n\n                })\n                .fail(function(xmlData) {\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                    deleteUploadToken(serverHost, ks, uploadTokenId);\n                    printErrorMessage(\"Cannot upload the file !<br>(Cannot connect to contents server.)\");\n                    return;\n                });\n            }\n\n            /**\n             * This function uploads metadata.\n             * @access public\n             * @param {string} serverHost - hostname of kaltura server.\n             * @param {string} ks - session string of kaltura connection.\n             * @param {string} uploadTokenId - upload token id.\n             * @param {string} entryId - id of media entry.\n             */\n            function attachUploadedFile(serverHost, ks, uploadTokenId, entryId) {\n                var entryStatus;\n                var entryName = \"\";\n                var entryTags = \"\";\n                var entryDescription = \"\";\n                var entryCreatorId = \"\";\n\n                var findData;\n\n                // Creates form data.\n                var fd = new FormData();\n                fd.append(\"action\", \"addContent\");\n                fd.append(\"ks\", ks);\n                fd.append(\"entryId\", entryId);\n                fd.append(\"resource:objectType\", \"KalturaUploadedFileTokenResource\");\n                fd.append(\"resource:token\", uploadTokenId);\n\n                // Creates transmission data.\n                var postData = {\n                    type: \"POST\",\n                    data: fd,\n                    cache: false,\n                    async: true,\n                    contentType: false,\n                    scriptCharset: \"utf-8\",\n                    processData: false,\n                    dataType: \"xml\"\n                };\n\n                var serviceURL = serverHost + \"/api_v3/service/media/action/addContent\";\n\n                // Transmits data.\n                $.ajax(\n                    serviceURL, postData\n                )\n                .done(function(xmlData) {\n                    // Response is not XML.\n                    if (xmlData === null || typeof xmlData === undefined) {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot attach uploaded file !<br>(Cannot get a XML response.)\");\n                        return;\n                    }\n\n                    // Get a tag of error code.\n                    findData = $(xmlData).find(\"code\");\n                    // There exists error code.\n                    if (findData !== null && typeof findData !== undefined && findData.text() !== \"\") {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot attach uploaded file !<br>(\" + findData.text() + \")\");\n                        return;\n                    }\n\n                    // Get a tag of status.\n                    findData = $(xmlData).find(\"status\");\n                    // There not exists a tag of status.\n                    if (findData === null || typeof findData === undefined || findData.text() === \"\") {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot attach uploaded file !<br>(Cannot get a mediaEntryStatus.)\");\n                        return;\n                    }\n\n                    // Get a value of status.\n                    entryStatus = findData.text();\n                    // When uploading of metadata failed.\n                    if (entryStatus != ENTRY_STATUS.ENTRY_READY && entryStatus != ENTRY_STATUS.ENTRY_PENDING &&\n                        entryStatus != ENTRY_STATUS.ENTRY_PRECONVERT && entryStatus != ENTRY_STATUS.IMPORT &&\n                        entryStatus != ENTRY_STATUS.IMPORTING) {\n                        deleteUploadToken(serverHost, ks, uploadTokenId);\n                        printErrorMessage(\"Cannot attach uploaded file !<br>(mediaEntryStatus: \" + entryStatus + \")\");\n                        return;\n                    }\n\n                    // Get a tag of entry id.\n                    findData = $(xmlData).find(\"id\");\n                    // Get a value of entry id.\n                    entryId = findData.text();\n                    // Get a tag of name.\n                    findData = $(xmlData).find(\"name\");\n                    // Get a value of name.\n                    entryName = findData.text();\n                    // Get a tag of tags.\n                    findData = $(xmlData).find(\"tags\");\n                    // Get a value of tags.\n                    entryTags = findData.text();\n                    // Get a tag of description.\n                    findData = $(xmlData).find(\"description\");\n                    // There exists description.\n                    if (findData !== null && typeof findData !== undefined && findData.text() !== \"\") {\n                        // Get a value of description.\n                        entryDescription = findData.text();\n                    } else {\n                        entryDescription = \"\";\n                    }\n                    // Get a tago of creator id.\n                    findData = $(xmlData).find(\"creatorId\");\n                    // Get a value of creator id.\n                    entryCreatorId = findData.text();\n\n                    // Prints success message.\n                    printSuccessMessage(entryId, entryName, entryTags, entryDescription, entryCreatorId);\n                    // Update hidden parameters on editors' page.\n                    updateHiddenParameters(entryId, entryName);\n                })\n                .fail(function(xmlData) {\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                    deleteUploadToken(serverHost, ks, uploadTokenId);\n                    printErrorMessage(\"Cannot attach uploaded file !<br>(Cannot connect to kaltura server.)\");\n                    return;\n                });\n            }\n\n            /**\n             * This function close kaltura session.\n             * @access public\n             */\n            function sessionEnd() {\n                var serverHost = $(\"#kalturahost\").val(); // Get hostname of kaltura server.\n                var serviceURL = serverHost + \"/api_v3/service/session/action/end\";\n\n                // Transmits data.\n                $.ajax({\n                    type: \"GET\",\n                    url: serviceURL,\n                    cache: false\n                })\n                .done(function(xmlData) {\n                    // Response is not XML.\n                    if (xmlData === null) {\n                        window.console.log(\"Cannot delete the uploadToken ! (Cannot get a XML response.)\");\n                    } else {\n                        window.console.log(\"Kaltura Session has been deleted.\");\n                    }\n                })\n                .fail(function(xmlData) {\n                    window.console.log(\"Cannot delete the uploadToken ! (Cannot connect to kaltura server.)\");\n                    if (xmlData !== null) {\n                        window.console.dir(xmlData);\n                    }\n                });\n            }\n\n            /**\n             * This function removes hidden parameters in parent document.\n             * @access public\n             */\n            function removeParameters() {\n                $('#yukaltura_select_id', parent.document).remove();\n                $('#yukaltura_select_name', parent.document).remove();\n                $('#yukaltura_host', parent.document).remove();\n                $('#yukaltura_partnerid', parent.document).remove();\n                $('#yukaltura_uiconfid', parent.document).remove();\n                $('#yukaltura_playerstudio', parent.document).remove();\n                $('#yukaltura_width', parent.document).remove();\n                $('#yukaltura_height', parent.document).remove();\n                $('#yukaltura_filetype', parent.document).remove();\n                $('#yukaltura_naturalwidth', parent.document).remove();\n                $('#yukaltura_naturalheight', parent.document).remove();\n            }\n\n            // This function execute when window is chagned.\n            $(window).on(\"change\", function() {\n                checkForm();\n            });\n\n            // This function execute when window is loaded.\n            $(window).on(\"load\", function() {\n                $(\"#name\").val(\"\");\n                $(\"#tags\").val(\"\");\n                $(\"#description\").val(\"\");\n            });\n\n            removeVideo();\n\n            // This function execute when window is uloaded.\n            $(window).on(\"unload\", function() {\n                if (blobUrl !== null) {\n                    if (window.URL && window.URL.revokeObjectURL) {\n                        window.URL.revokeObjectURL(blobUrl);\n                    } else {\n                        window.webkitURL.revokeObjectURL(blobUrl);\n                    }\n                    videoBlob = null;\n                    blobUrl = null;\n                }\n\n                if (localStream !== null) {\n                    if (localStream.getTracks) {\n                        var tracks = localStream.getTracks();\n                        for (var i = tracks.length - 1; i >= 0; --i) {\n                            tracks[i].stop();\n                        }\n                    } else {\n                        localStream.stop();\n                    }\n                    if (document.getElementById(\"webcam\").srcObject) {\n                        document.getElementById(\"webcam\").srcObject = null;\n                    }\n                }\n\n                sessionEnd();\n            });\n\n            $(\"#name\").on(\"change\", function() {\n                checkForm();\n            });\n\n            $(\"#tags\").on(\"change\", function() {\n                checkForm();\n            });\n\n            $(\"#entry_submit\").on(\"click\", function() {\n                handleSubmitClick();\n            });\n\n            $(\"#entry_reset\").on(\"click\", function() {\n                handleResetClick();\n            });\n\n            removeParameters();\n            // Dsiable Insert button.\n            disableInsertButton();\n            // Enable cancel button.\n            enableCancelButton();\n        }\n    };\n});\n"],"file":"attorecorder.min.js"}