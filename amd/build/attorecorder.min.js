function _typeof(e){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}define ("atto_yukaltura/attorecorder",["jquery"],function(t){return{init:function init(){var M=0,B=!1,Y="",G="",F=0,z=0,V=400,K=300,X=null,q=null,W="",H=null,Q=null,Z=null,$=window.URL&&window.URL.createObjectURL?function(e){return window.URL.createObjectURL(e)}:window.webkitURL&&window.webkitURL.createObjectURL?function(e){return window.webkitURL.createObjectURL(e)}:void 0,J=window.URL&&window.URL.revokeObjectURL?function(e){return window.URL.revokeObjectURL(e)}:window.webkitURL&&window.webkitURL.revokeObjectURL?function(e){return window.webkitURL.revokeObjectURL(e)}:void 0,ee={VIDEO:1,IMAGE:2,AUDIO:5},te={TRUE:1,FALSE:0,NULL:-1},ne={ENTRY_IMPORTING:-2,ENTRY_CONVERTING:-1,ENTRY_IMPORT:0,ENTRY_PRECONVERT:1,ENTRY_READY:2,ENTRY_DELETED:3,ENTRY_PENDING:4,ENTRY_MODERATE:5,ENTRY_BLOCKED:6,ENTRY_NO_CONTENT:7},de={PENDING:0,PARTIAL_UPLOAD:1,FULL_UPLOAD:2,CLOSED:3,TIMED_OUT:4,DELETED:5};function e(){var e=navigator.userAgent.toLowerCase(),t=navigator.appVersion.toLowerCase(),n=-1<e.indexOf("msie")&&-1==e.indexOf("opera"),d=n&&-1<t.indexOf("msie 6."),a=n&&-1<t.indexOf("msie 7."),i=n&&-1<t.indexOf("msie 8."),o=n&&-1<t.indexOf("msie 9."),r=n&&-1<t.indexOf("msie 10."),u=-1<e.indexOf("trident/7");return n||d||a||i||o||r||u}function n(){var e=navigator.userAgent.toLowerCase(),t=-1<e.indexOf("edge"),n=-1<e.indexOf("chrome")&&-1==e.indexOf("edge"),d=-1<e.indexOf("firefox"),a=-1<e.indexOf("safari")&&-1==e.indexOf("chrome"),i=-1<e.indexOf("opera");return!0===t&&!1===n&&!1===d&&!1===a&&!1===i}function d(){if(e()||n()){var d="";if(e()){d="Internet Explorer"}else{d="Edge"}require(["core/str"],function(e){var n=e.get_string("unsupported_browser","local_yumymedia",d);t.when(n).done(function(e){u(e)})});U();E();return!0}return!1}function a(){var e,t=navigator.userAgent;if(t.match(/iPhone|iPad|iPod/)){e="iOS"}else if(t.match(/Android|android/)){e="Android"}else if(t.match(/Linux|linux/)){e="Linux"}else if(t.match(/Win(dows)/)){e="Windows"}else if(t.match(/Mac|PPC/)){e="Mac OS"}else if(t.match(/CrOS/)){e="Chrome OS"}else{e="Other"}return e}function o(){var e=a();if("iOS"==e||"Android"==e){require(["core/str"],function(n){var d=n.get_string("unsupported_os","local_yumymedia",e);t.when(d).done(function(e){u(e)})});U();E();return!0}return!1}function r(){var e=window.location.protocol;if(-1!=e.indexOf("https")){return!0}return!1}function u(e){var n="";n="<p><font color=\"red\">"+e+"</font></p>";t("#upload_info").html(n);U();E()}function c(e){var n="<video id=\"webcam\" width=\""+V+"\" height=\""+K+"\" ";n=n+"src=\""+e+"\" autoplay=\"false\" oncontextmenu=\"return false;\" controls></video>";t("#videospan").html(n);document.getElementById("webcam").pause();document.getElementById("webcam").currentTime=0}function l(e){var n="<video id=\"webcam\" width=\""+V+"\" height=\""+K+"\" ";n=n+"autoplay=\"0\" muted oncontextmenu=\"return false;\"></video>";t("#videospan").html(n);t("#webcam").attr("src",e)}function s(){t("#recstop").attr("src",t("#stopurl").val());t("#recstop").off("click");t("#recstop").on("click",function(){p()});t("#leftspan").css("display","inline");t("#webcam").volume=0;Q.start();require(["core/str"],function(e){var n=e.get_string("now_recording","local_yumymedia",null);t.when(n).done(function(e){t("#status").html("<font color=\"red\">"+e+"</font>")})})}function p(){Q.ondataavailable=function(e){q=new Blob([e.data],{type:e.data.type});if(window.URL&&window.URL.createObjectURL){H=window.URL.createObjectURL(q)}else{H=window.webkitURL.createObjectURL(q)}c(H);M=q.size;var n="",d=0;if(M>1073741824){d=M/1073741824;n=d.toFixed(2)+" G"}else if(M>1048576){d=M/1048576;n=d.toFixed(2)+" M"}else if(1024<M){d=M/1024;n=d.toFixed(2)+" k"}else{n=M+" "}require(["core/str"],function(e){var d=e.get_string("video_preview","local_yumymedia",null);t.when(d).done(function(e){e="<font color=\"green\">"+e+"("+q.type+", ";e=e+n+"B).</font>";t("#status").html(e)})});Y=y(q.type);B=f();if(!1===B){require(["core/str"],function(e){var n=e.get_string("wrong_filesize","local_yumymedia",null);t.when(n).done(function(e){window.alert(e)})});G=Y;F=0;z=0}v();W=t("#filename").val()+"."+_(q.type)};if(X.getTracks!==void 0&&null!==X.getTracks){for(var e=X.getTracks(),n=e.length-1;0<=n;--n){e[n].stop()}if(document.getElementById("webcam").srcObject!==void 0){document.getElementById("webcam").srcObject=null}}Q.stop();t("#leftspan").css("display","none");t("#rightspan").css("display","inline");t("#remove").on("click",function(){m()})}function m(){if(!r()){require(["core/str"],function(e){var n=e.get_string("require_https","local_yumymedia");t.when(n).done(function(e){u(e)})});return}if(d()||o()){return}navigator.mediaDevices=navigator.mediaDevices||(navigator.mozGetUserMedia||navigator.webkitGetUserMedia?{getUserMedia:function getUserMedia(e){return function(t,d){(navigator.mozGetUserMedia||navigator.webkitGetUserMedia).call(navigator,e,t,d)}}}:null);try{if(null===navigator.mediaDevices||navigator.mediaDevices===void 0||null===MediaRecorder||MediaRecorder===void 0){require(["core/str"],function(e){var n=e.get_string("disable_webrtc","local_yumymedia",null);t.when(n).done(function(e){u(e)})});return}if(null===$||$===void 0||null===J||J===void 0){require(["core/str"],function(e){var n=e.get_string("disable_objecturl","local_yumymedia",null);t.when(n).done(function(e){u(e)})});return}}catch(e){require(["core/str"],function(e){var n=e.get_string("disable_webrtc","local_yumymedia",null);t.when(n).done(function(e){u(e)})});window.console.log(e);return}l(null);if(null!==H){if(window.URL&&window.URL.revokeObjectURL){window.URL.revokeObjectURL(H)}else{window.webkitURL.revokeObjectURL(H)}H=null;q=null}if(null!==X){if(X.getTracks!==void 0||null!==X.getTracks){for(var e=X.getTracks(),n=e.length-1;0<=n;--n){e[n].stop()}if(document.getElementById("webcam").srcObject){document.getElementById("webcam").srcObject=null}}else{X.stop()}}M=0;B=!1;Y="";t("#recstop").off("click");t("#remove").off("click");t("#webcam").off("ondataavailable");var a="",c=MediaSource||MediaRecorder;if(c.isTypeSupported("video/webm")){a="video/webm"}else if(c.isTypeSupported("video/mp4")){a="video/mp4"}else if(c.isTypeSupported("video/webm;codecs=vp8,opus")){a="video/webm; codecs=vp8,opus"}else if(c.isTypeSupported("video/webm;codecs=vp9,opus")){a="video/webm; codecs=vp9,opus"}else if(c.isTypeSupported("video/webm;codecs=vp8")){a="video/webm; codecs=vp8"}else{a="video/webm; codecs=vp9"}Z={audioBitsPerSecond:128e3,videoBitsPerSecond:15e5,mimeType:a,audio:{echoCancellation:!1},video:{mandatory:{minWidth:320,minHeight:240,maxWidth:1280,maxHeight:720,minFrameRate:5,maxFrameRate:15},optional:[{facingMode:"user"}]}};var m=navigator.mediaDevices.getUserMedia(Z);m.then(function(e){X=e;var n=document.getElementById("webcam");if(n.srcObject!==void 0){n.srcObject=X;n.play()}else{if(window.URL&&window.URL.createObjectURL){H=window.URL.createObjectURL(H)}else{H=window.webkitURL.createObjectURL(H)}t("#webcam").attr("src",H)}window.console.log(X);if(null!==MediaSource||MediaSource!==void 0){Q=new MediaRecorder(X)}else{Q=new MediaRecorder(X,Z)}t("#recstop").attr("src",t("#recurl").val());t("#recstop").on("click",function(){s()});t("#leftspan").css("display","inline");t("#rightspan").css("display","none");require(["core/str"],function(e){var n=e.get_string("camera_preview","local_yumymedia",null);t.when(n).done(function(e){t("#status").html(e)})});v();return 0}).catch(function(e){require(["core/str"],function(e){var n=e.get_string("unsupported_camera","local_yumymedia",null);t.when(n).done(function(e){u(e)})});window.console.log(e);return-1})}function f(){if(0>=M){return!1}if(2e9<M){return!1}return!0}function y(e){if(-1!=e.indexOf("video/avi")||-1!=e.indexOf("video/x-msvideo")||-1!=e.indexOf("video/mpeg")||-1!=e.indexOf("video/mpg")||-1!=e.indexOf("video/mp4")||e.indexOf("video/ogg")||-1!=e.indexOf("video/quicktime")||-1!=e.indexOf("video/VP8")||-1!=e.indexOf("video/x-flv")||-1!=e.indexOf("video/x-f4v")||-1!=e.indexOf("video/x-matroska")||-1!=e.indexOf("video/x-ms-wmv")||-1!=e.indexOf("video/webm")){return"video"}if(-1!=e.indexOf("audio/ac3")||-1!=e.indexOf("audio/ogg")||-1!=e.indexOf("audio/mpeg")||-1!=e.indexOf("audio/mp4")||-1!=e.indexOf("audio/mp3")||-1!=e.indexOf("audio/wav")||-1!=e.indexOf("audio/x-ms-wma")){return"audio"}if(-1!=e.indexOf("image/gif")||-1!=e.indexOf("image/jpeg")||-1!=e.indexOf("image/png")||-1!=e.indexOf("image/tiff")){return"image"}return"N/A"}function _(e){if(-1!=e.indexOf("video/avi")||-1!=e.indexOf("video/x-msvideo")){return"avi"}if(-1!=e.indexOf("video/mpeg")||-1!=e.indexOf("video/mpg")||-1!=e.indexOf("audio/mpeg")||-1!=e.indexOf("audio/mpg")){return"mpeg"}if(-1!=e.indexOf("video/mp4")||-1!=e.indexOf("video/m4v")||-1!=e.indexOf("audio/mp4")){return"mp4"}if(-1!=e.indexOf("video/ogg")){return"ogg"}if(-1!=e.indexOf("video/quicktime")){return"mov"}if(-1!=e.indexOf("video/VP8")||-1!=e.indexOf("video/VP9")||-1!=e.indexOf("video/vp8")||-1!=e.indexOf("video/vp9")||-1!=e.indexOf("video/webm")){return"webm"}if(-1!=e.indexOf("video/x-flv")||-1!=e.indexOf("video/x-f4v")){return"flv"}if(-1!=e.indexOf("video/x-matroska")){return"mkv"}if(-1!=e.indexOf("video/x-ms-wmv")){return"wmv"}if(-1!=e.indexOf("audio/ac3")){return"ac3"}if(-1!=e.indexOf("audio/ogg")){return"ogg"}if(-1!=e.indexOf("audio/wav")){return"wav"}if(-1!=e.indexOf("audio/x-ms-wma")){return"wma"}if(-1!=e.indexOf("image/gif")){return"gif"}if(-1!=e.indexOf("image/jpeg")){return"jpg"}if(-1!=e.indexOf("image/png")){return"png"}if(-1!=e.indexOf("image/tiff")){return"tiff"}return"webm"}function v(){if(null===H||null===q||0===q.size||!1===B||""===t("#name").val()||""===t("#tags").val()||""===Y||"N/A"===Y){t("#entry_submit").prop("disabled",!0);t("#entry").val("")}else{t("#entry_submit").prop("disabled",!1)}}function g(e){t("#upload_info").html("");t("#upload_info").append("<font color=\"red\">"+e+"</font><br>");U();E()}function h(e,n,d,a,i){require(["core/str","core/notification"],function(o,r){o.get_strings([{key:"upload_success",component:"local_yumymedia"},{key:"entryid_header",component:"local_yumymedia"},{key:"name_header",component:"local_yumymedia"},{key:"tags_header",component:"local_yumymedia"},{key:"desc_header",component:"local_yumymedia"},{key:"creatorid_header",component:"local_yumymedia"},{key:"insert_media",component:"atto_yukaltura"}]).then(function(o){var r="<h3>"+o[0]+"</h3>";r+="<table border=\"2\" cellpadding=\"5\">";r+="<tr><td>"+o[1]+"</td><td>"+e+"</td></tr>";r+="<tr><td>"+o[2]+"</td><td>"+n+"</td></tr>";r+="<tr><td>"+o[3]+"</td><td>"+d+"</td></tr>";r+="<tr><td>"+o[4]+"</td><td>"+a+"</td></tr>";r+="<tr><td>"+o[5]+"</td><td>"+i+"</td></tr>";r+="</table>";r+="<br>";r+="<p><font color=\"red\">"+o[6]+"</font></p>";t("#upload_info").html(r);return 0}).fail(r.exception)});L();E()}function k(){t("#file_info").html("");t("#type").val("");G="";F=0;z=0;U();E()}function x(e){var t=/["$%&'~^\\`/]/;if(!0===t.test(e)){return!1}else{return!0}}function b(e){var t=/[!"#$%&'~|^\\@`()[\]{}:;+*/=<>?]/;if(!0===t.test(e)){return!1}else{return!0}}function O(){var e=t("#name").val(),n=t("#tags").val(),d=t("#description").val(),a=!0;if(!1===x(e)){require(["core/str"],function(e){var n=e.get_string("wrong_name","local_yumymedia",null);t.when(n).done(function(e){window.alert(e)})});a=!1}if(!1===b(n)){require(["core/str"],function(e){var n=e.get_string("wrong_tags","local_yumymedia",null);t.when(n).done(function(e){window.alert(e)})});a=!1}if(!1===x(d)){require(["core/str"],function(e){var n=e.get_string("wrong_desc","local_yumymedia",null);t.when(n).done(function(e){window.alert(e)})});a=!1}return a}function w(){if(!1===O()){return!1}if(!1===f()){require(["core/str"],function(e){var n=e.get_string("wrong_filesize","local_yumymedia",null);t.when(n).done(function(e){window.alert(e)})});return!1}t("#entry_submit").prop("disabled",!0);j();return!0}function T(){if(null===parent.document.getElementById("yukaltura_select_id")||null===parent.document.getElementById("yukaltura_select_id")[0]){var e=t("body",parent.document),n="<input type=\"hidden\" name=\"yukaltura_select_id\" id=\"yukaltura_select_id\" value=\"\">";e.append(n);n="<input type=\"hidden\" name=\"yukaltura_select_name\" id=\"yukaltura_select_name\" value=\"\">";e.append(n);var d=t("#kalturahost").val();n="<input type=\"hidden\" name=\"yukaltura_host\" id=\"yukaltura_host\" value=\"";n=n+d+"\">";e.append(n);var a=t("#partnerid").val();n="<input type=\"hidden\" name=\"yukaltura_partnerid\" id=\"yukaltura_partnerid\" value=\"";n=n+a+"\">";e.append(n);var i=t("#uiconfid").val();n="<input type=\"hidden\" name=\"yukaltura_uiconfid\" id=\"yukaltura_uiconfid\" value=\"";n=n+i+"\">";e.append(n);var o=t("#player_width").val();n="<input type=\"hidden\" name=\"yukaltura_width\" id=\"yukaltura_width\" value=\""+o+"\">";e.append(n);var r=t("#player_height").val();n="<input type=\"hidden\" name=\"yukaltura_height\" id=\"yukaltura_height\" value=\""+r+"\">";e.append(n);n="<input type=\"hidden\" name=\"yukaltura_filetype\" id=\"yukaltura_filetype\" value=\"\">";e.append(n);n="<input type=\"hidden\" name=\"yukaltura_naturalwidth\" id=\"yukaltura_naturalwidth\" value=\"\">";e.append(n);n="<input type=\"hidden\" name=\"yukaltura_naturalheight\" id=\"yukaltura_naturalheight\" value=\"\">";e.append(n)}}function R(e,n){if(null!==e&&""!==e&&null!==parent.document.getElementById("yukaltura_select_id")&&null!==parent.document.getElementById("yukaltura_select_id")[0]){t("#yukaltura_select_id",parent.document).val(e);t("#yukaltura_select_name",parent.document).val(n);t("#yukaltura_filetype",parent.document).val(G);t("#yukaltura_naturalwidth",parent.document).val(F);t("#yukaltura_naturalheight",parent.document).val(z)}}function L(){t("#yukaltura_insert_btn",parent.document).prop("disabled",!1);t("#yukaltura_insert_btn",parent.document).css({opacity:"1.0"})}function U(){t("#yukaltura_insert_btn",parent.document).prop("disabled",!0);t("#yukaltura_insert_btn",parent.document).css({opacity:"0.5"})}function E(){t("#yukaltura_cancel_btn",parent.document).prop("disabled",!1);t("#yukaltura_cancel_btn",parent.document).css({opacity:"1.0"})}function C(){t("#yukaltura_cancel_btn",parent.document).prop("disabled",!0);t("#yukaltura_cancel_btn",parent.document).css({opacity:"0.5"})}function j(){var e=t("#kalturahost").val(),n=t("#ks").val();U();C();T();N(e,n)}function I(e,n,d){var a=new FormData,i;a.append("action","delete");a.append("ks",n);a.append("uploadTokenId",d);t.ajax(e+"/api_v3/service/uploadToken/action/delete",{type:"POST",data:a,cache:!1,contentType:!1,scriptCharset:"utf-8",processData:!1,async:!0,dataType:"xml"}).done(function(e){if(null===e){i=!1}i=!0}).fail(function(e){i=!1;if(null!==e){window.console.dir(e)}});return i}function N(e,n){var d,a,i=e+"/api_v3/service/uploadToken/action/add?ks="+n;i=i+"&uploadToken:objectType=KalturaUploadToken";i=i+"uploadToken:fileName="+encodeURI(W);i=i+"&uploadToken:fileSize="+q.size;i=i+"&uploadToken:autoFinalize="+te.NULL;t.ajax(i,{type:"GET",cache:!1,async:!0,contentType:!1,scriptCharset:"utf-8",dataType:"xml"}).done(function(i){if(null===i){g("Cannot create upload token !<br>(Cannot get a XML response.)");return}a=t(i).find("code");if(null!==a&&_typeof(a)!==void 0&&""!==a.text()){g("Cannot create upload token !<br>("+a.text()+")");return}a=t(i).find("status");if(null===a||_typeof(a)===void 0||""===a.text()){g("Cannot create upload token !<br>(Cannot get status of upload token.)");return}var o=a.text();if(o!=de.PENDING){g("Cannot create upload token !<br>(UPLOAD_TOKEN_STATUS : "+o+")");return}a=t(i).find("id");if(null===a||_typeof(a)===void 0||""===a.text()){g("Cannot create uplaod token !<br>(Cannot get an uploadTokenId.)");return}d=a.text();setTimeout(function(){D(e,n,d)},50)}).fail(function(e){if(null!==e){window.console.dir(e)}g("Cannot create upload token !<br>(Cannot connect to kaltura server.)")})}function D(e,n,d){var a,i,o="",r="",u="",c="",l="",s=t("#name").val(),p=t("#tags").val(),m=t("#description").val(),f=t("#controlId").val(),y=t("#creatorId").val();s=s.trim();p=p.trim();if(null!==m){m=m.trim()}var _=new FormData;_.append("action","add");_.append("ks",n);_.append("entry:objectType","KalturaMediaEntry");_.append("entry:mediaType",ee.VIDEO);_.append("entry:sourceType",1);_.append("entry:name",s);_.append("entry:tags",p);if(null!==m&&""!==m){_.append("entry:description",m)}else{_.append("entry:description","")}_.append("entry:categories",t("#categories").val());if(null!==f&&""!==f){_.append("entry:accessControlId",f)}_.append("entry:creatorId",y);_.append("entry:userId",y);t.ajax(e+"/api_v3/service/media/action/add",{type:"POST",data:_,cache:!1,async:!0,contentType:!1,scriptCharset:"utf-8",processData:!1,dataType:"xml"}).done(function(s){if(null===s||_typeof(s)===void 0){I(e,n,d);g("Cannot create media entry !<br>(Cannot get a XML response.)");return}a=t(s).find("code");if(null!==a&&_typeof(a)!==void 0&&""!==a.text()){I(e,n,d);g("Cannot create media entry !<br>("+a.text()+")");return}a=t(s).find("status");if(null===a||_typeof(a)===void 0||""===a.text()){I(e,n,d);g("Cannot create media entyry !<br>(Cannot get a mediaEntryStatus.)");return}i=a.text();if(i!=ne.ENTRY_NO_CONTENT){I(e,n,d);g("Cannot create media entry!<br>(mediaEntryStatus: "+i+")");return}a=t(s).find("id");o=a.text();a=t(s).find("name");r=a.text();a=t(s).find("tags");u=a.text();a=t(s).find("description");if(null!==a&&_typeof(a)!==void 0&&""!==a.text()){c=a.text()}else{c=""}a=t(s).find("creatorId");l=a.text();if(null===o||""===o||null===r||""===r||null===u||""===u||null===l||""===l||""!==m&&(null===c||""===c)){I(e,n,d);g("There exists wrong information(s) <br>");return}setTimeout(function(){S(e,n,d,o)},50)}).fail(function(t){if(null!==t){window.console.dir(t)}I(e,n,d);g("Cannot create media entry !<br>(Cannot connect to kaltura server.)")})}function S(e,n,d,a){var i,o=new FormData;t("#upload_info").html("");require(["core/str"],function(e){var n=e.get_string("recorder_uploading","local_yumymedia",null);t.when(n).done(function(e){t("#upload_info").append(e+"<br>")})});require(["core/str"],function(e){var n=e.get_string("progress","local_yumymedia",null);t.when(n).done(function(e){var n="<p>"+e;n=n+": <span id=\"pvalue\" style=\"color:#00b200\">0.00</span> %</p>";t("#upload_info").append(n)})});o.append("action","upload");o.append("ks",n);o.append("uploadTokenId",d);o.append("fileData",q,encodeURI(W),q.size);o.append("resume",!1);o.append("finalChunk",!0);o.append("resumeAt",0);t.ajax(e+"/api_v3/service/uploadToken/action/upload",{type:"POST",data:o,cache:!1,async:!0,contentType:!1,scriptCharset:"utf-8",processData:!1,dataType:"xml",xhr:function xhr(){var e=t.ajaxSettings.xhr();if(e.upload){e.upload.addEventListener("progress",function(n){var e=parseInt(100*(n.loaded/n.total));t("#pvalue").html(parseInt(e))},!1)}return e}}).done(function(o){if(null===o){I(e,n,d);g("Cannot upload the video !<br>(Cannot get a XML response.)");return}i=t(o).find("code");if(null!==i&&_typeof(i)!==void 0&&""!==i.text()){I(e,n,d);g("Cannot upload the video !<br>("+i.text()+")");return}i=t(o).find("status");if(null===i||_typeof(i)===void 0||""===i.text()){I(e,n,d);g("Cannot upload the video !<br>(Cannot get an uploadTokenStatus.)");return}var r=i.text();if(r!=de.FULL_UPLOAD&&r!=de.PARTIAL_UPLOAD){I(e,n,d);g("Cannot upload the video !<br>(UPLOAD_TOKEN_STATUS : "+r+")");return}else{window.console.log("File chunk have been transmitted.")}require(["core/str"],function(e){var n=e.get_string("attach_file","local_yumymedia",null);t.when(n).done(function(e){t("#upload_info").append(e+"<br>")})});setTimeout(function(){P(e,n,d,a)},1e3)}).fail(function(t){if(null!==t){window.console.dir(t)}I(e,n,d);g("Cannot upload the file !<br>(Cannot connect to contents server.)")})}function P(e,n,d,a){var i,o="",r="",u="",c="",l,s=new FormData;s.append("action","addContent");s.append("ks",n);s.append("entryId",a);s.append("resource:objectType","KalturaUploadedFileTokenResource");s.append("resource:token",d);t.ajax(e+"/api_v3/service/media/action/addContent",{type:"POST",data:s,cache:!1,async:!0,contentType:!1,scriptCharset:"utf-8",processData:!1,dataType:"xml"}).done(function(s){if(null===s||_typeof(s)===void 0){I(e,n,d);g("Cannot attach uploaded file !<br>(Cannot get a XML response.)");return}l=t(s).find("code");if(null!==l&&_typeof(l)!==void 0&&""!==l.text()){I(e,n,d);g("Cannot attach uploaded file !<br>("+l.text()+")");return}l=t(s).find("status");if(null===l||_typeof(l)===void 0||""===l.text()){I(e,n,d);g("Cannot attach uploaded file !<br>(Cannot get a mediaEntryStatus.)");return}i=l.text();if(i!=ne.ENTRY_READY&&i!=ne.ENTRY_PENDING&&i!=ne.ENTRY_PRECONVERT&&i!=ne.IMPORT&&i!=ne.IMPORTING){I(e,n,d);g("Cannot attach uploaded file !<br>(mediaEntryStatus: "+i+")");return}l=t(s).find("id");a=l.text();l=t(s).find("name");o=l.text();l=t(s).find("tags");r=l.text();l=t(s).find("description");if(null!==l&&_typeof(l)!==void 0&&""!==l.text()){u=l.text()}else{u=""}l=t(s).find("creatorId");c=l.text();h(a,o,r,u,c);R(a,o)}).fail(function(t){if(null!==t){window.console.dir(t)}I(e,n,d);g("Cannot attach uploaded file !<br>(Cannot connect to kaltura server.)")})}function A(){var e=t("#kalturahost").val();t.ajax({type:"GET",url:e+"/api_v3/service/session/action/end",cache:!1}).done(function(e){if(null===e){window.console.log("Cannot delete the uploadToken ! (Cannot get a XML response.)")}else{window.console.log("Kaltura Session has been deleted.")}}).fail(function(e){window.console.log("Cannot delete the uploadToken ! (Cannot connect to kaltura server.)");if(null!==e){window.console.dir(e)}})}t(window).on("change",function(){v()});t(window).on("load",function(){t("#name").val("");t("#tags").val("");t("#description").val("")});m();t(window).on("unload",function(){if(null!==H){if(window.URL&&window.URL.revokeObjectURL){window.URL.revokeObjectURL(H)}else{window.webkitURL.revokeObjectURL(H)}q=null;H=null}if(null!==X){if(X.getTracks){for(var e=X.getTracks(),t=e.length-1;0<=t;--t){e[t].stop()}}else{X.stop()}if(document.getElementById("webcam").srcObject){document.getElementById("webcam").srcObject=null}}A()});t("#name").on("change",function(){v()});t("#tags").on("change",function(){v()});t("#entry_submit").on("click",function(){w()});t("#entry_reset").on("click",function(){k()});(function(){t("#yukaltura_select_id",parent.document).remove();t("#yukaltura_select_name",parent.document).remove();t("#yukaltura_host",parent.document).remove();t("#yukaltura_partnerid",parent.document).remove();t("#yukaltura_uiconfid",parent.document).remove();t("#yukaltura_width",parent.document).remove();t("#yukaltura_height",parent.document).remove();t("#yukaltura_filetype",parent.document).remove();t("#yukaltura_naturalwidth",parent.document).remove();t("#yukaltura_naturalheight",parent.document).remove()})();U();E()}}});
//# sourceMappingURL=attorecorder.min.js.map
