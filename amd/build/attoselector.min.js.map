{"version":3,"file":"attoselector.min.js","sources":["../src/attoselector.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Media Secctor script for kaltura media embed.\n *\n * @copyright (C) 2019-2023 Yamaguchi University (gh-cc@mlex.cc.yamaguchi-u.ac.jp)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module atto_yukaltura/attoselector\n */\n\ndefine(['jquery'], function($) {\n\n    return {\n        /**\n         * Initial function.\n         * @access public\n         */\n        init: function() {\n\n            /**\n             * This function reflects change of sort option.\n             * @access public\n             */\n            function changeSort() {\n                // Get url.\n                var url = $(\"#selectorSort\").val();\n                // Change url of selector window.\n                location.href = url;\n\n                removeParameters();\n                // Dsiable Insert button.\n                $(\"#yukaltura_insert_btn\", parent.document).prop(\"disabled\", true);\n                $(\"#yukaltura_insert_btn\", parent.document).css({opacity: \"0.5\"});\n            }\n\n            /**\n             * This is callback function for thumbnail click.\n             * @access public\n             * @param {object} e - event object of target image.\n             */\n            function clickThumbnailImage(e) {\n                var selectId = e.target.id;\n                var selectName = e.target.alt;\n\n                var fileType = $('#' + selectId + '_filetype').val();\n                var naturalWidth = $('#' + selectId + '_width').val();\n                var naturalHeight = $('#' + selectId + '_height').val();\n\n                // Set name of selected media.\n                $(\"#select_name\").html(selectName);\n\n                // Create new element if entry id element is null.\n                if (parent.document.getElementById('yukaltura_select_id') === null ||\n                    parent.document.getElementById('yukaltura_select_id')[0] === null) {\n                    var element = $('body', parent.document);\n\n                    var str = '<input type=\"hidden\" name=\"yukaltura_select_id\" id=\"yukaltura_select_id\" value=\"\">';\n                    element.append(str);\n\n                    str = '<input type=\"hidden\" name=\"yukaltura_select_name\" id=\"yukaltura_select_name\" value=\"\">';\n                    element.append(str);\n\n                    var kalturahost = $('#kalturahost').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_host\" id=\"yukaltura_host\" value=\"';\n                    str = str + kalturahost + '\">';\n                    element.append(str);\n\n                    var partnerid = $('#partnerid').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_partnerid\" id=\"yukaltura_partnerid\" value=\"';\n                    str = str + partnerid + '\">';\n                    element.append(str);\n\n                    var uiconfid = $('#uiconfid').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_uiconfid\" id=\"yukaltura_uiconfid\" value=\"';\n                    str = str + uiconfid + '\">';\n                    element.append(str);\n\n                    var width = $('#player_width').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_width\" id=\"yukaltura_width\" value=\"' + width + '\">';\n                    element.append(str);\n\n                    var height = $('#player_height').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_height\" id=\"yukaltura_height\" value=\"' + height + '\">';\n                    element.append(str);\n\n                    var studio = $('#player_studio').val();\n                    str = '<input type=\"hidden\" name=\"yukaltura_playerstudio\" id=\"yukaltura_playerstudio\" value=\"' + studio + '\">';\n                    element.append(str);\n\n                    str = '<input type=\"hidden\" name=\"yukaltura_filetype\" id=\"yukaltura_filetype\" value=\"\">';\n                    element.append(str);\n\n                    str = '<input type=\"hidden\" name=\"yukaltura_naturalwidth\" id=\"yukaltura_naturalwidth\" value=\"\">';\n                    element.append(str);\n\n                    str = '<input type=\"hidden\" name=\"yukaltura_naturalheight\" id=\"yukaltura_naturalheight\" value=\"\">';\n                    element.append(str);\n                }\n\n                // Set entry id of selected media.\n                $('#yukaltura_select_id', parent.document).val(selectId);\n                // Set entry name of selected media.\n                $('#yukaltura_select_name', parent.document).val(selectName);\n                // Set natural width of selected media.\n                $('#yukaltura_filetype', parent.document).val(fileType);\n                // Set natural width of selected media.\n                $('#yukaltura_naturalwidth', parent.document).val(naturalWidth);\n                // Set natural height of selected media.\n                $('#yukaltura_naturalheight', parent.document).val(naturalHeight);\n\n                // Enable Insert button.\n                $(\"#yukaltura_insert_btn\", parent.document).prop(\"disabled\", false);\n                $(\"#yukaltura_insert_btn\", parent.document).css({opacity: \"1.0\"});\n            }\n\n            /**\n             * This function removes hidden parameters in parent document.\n             * @access public\n             */\n            function removeParameters() {\n                $('#yukaltura_select_id', parent.document).remove();\n                $('#yukaltura_select_name', parent.document).remove();\n                $('#yukaltura_host', parent.document).remove();\n                $('#yukaltura_partnerid', parent.document).remove();\n                $('#yukaltura_uiconfid', parent.document).remove();\n                $('#yukaltura_playerstudio', parent.document).remove();\n                $('#yukaltura_width', parent.document).remove();\n                $('#yukaltura_height', parent.document).remove();\n                $('#yukaltura_filetype', parent.document).remove();\n                $('#yukaltura_naturalwidth', parent.document).remove();\n                $('#yukaltura_naturalheight', parent.document).remove();\n            }\n\n            $(\"#selectorSort\").on(\"change\", function() {\n                changeSort();\n            });\n\n            $(\".media_thumbnail\").on(\"click\", function(e) {\n                clickThumbnailImage(e);\n            });\n\n            removeParameters();\n            // Dsiable Insert button.\n            $('#yukaltura_insert_btn', parent.document).prop(\"disabled\", true);\n            $('#yukaltura_insert_btn', parent.document).css({opacity: \"0.5\"});\n        }\n    };\n});\n"],"names":["define","$","init","removeParameters","parent","document","remove","on","url","val","location","href","prop","css","opacity","e","selectId","target","id","selectName","alt","fileType","naturalWidth","naturalHeight","html","getElementById","element","str","append","clickThumbnailImage"],"mappings":";;;;;;AA0BAA,qCAAO,CAAC,WAAW,SAASC,GAExB,MAAO,CAKHC,KAAM,WAsGF,SAASC,mBACLF,EAAE,uBAAwBG,OAAOC,UAAUC,SAC3CL,EAAE,yBAA0BG,OAAOC,UAAUC,SAC7CL,EAAE,kBAAmBG,OAAOC,UAAUC,SACtCL,EAAE,uBAAwBG,OAAOC,UAAUC,SAC3CL,EAAE,sBAAuBG,OAAOC,UAAUC,SAC1CL,EAAE,0BAA2BG,OAAOC,UAAUC,SAC9CL,EAAE,mBAAoBG,OAAOC,UAAUC,SACvCL,EAAE,oBAAqBG,OAAOC,UAAUC,SACxCL,EAAE,sBAAuBG,OAAOC,UAAUC,SAC1CL,EAAE,0BAA2BG,OAAOC,UAAUC,SAC9CL,EAAE,2BAA4BG,OAAOC,UAAUC,SAGnDL,EAAE,iBAAiBM,GAAG,UAAU,WA9GhC,IAEQC,QAAMP,EAAE,iBAAiBQ,MAE7BC,SAASC,KAAOH,IAEhBL,mBAEAF,EAAE,wBAAyBG,OAAOC,UAAUO,KAAK,YAAY,GAC7DX,EAAE,wBAAyBG,OAAOC,UAAUQ,IAAI,CAACC,QAAS,WAyG9Db,EAAE,oBAAoBM,GAAG,SAAS,SAASQ,IAjG3C,SAA6BA,GACzB,IAAIC,SAAWD,EAAEE,OAAOC,GACpBC,WAAaJ,EAAEE,OAAOG,IAEtBC,SAAWpB,EAAE,IAAMe,SAAW,aAAaP,MAC3Ca,aAAerB,EAAE,IAAMe,SAAW,UAAUP,MAC5Cc,cAAgBtB,EAAE,IAAMe,SAAW,WAAWP,MAMlD,GAHAR,EAAE,gBAAgBuB,KAAKL,YAGuC,OAA1Df,OAAOC,SAASoB,eAAe,wBAC8B,OAA7DrB,OAAOC,SAASoB,eAAe,uBAAuB,GAAa,CACnE,IAAIC,QAAUzB,EAAE,OAAQG,OAAOC,UAE3BsB,IAAM,qFACVD,QAAQE,OAAOD,KAEfA,IAAM,yFACND,QAAQE,OAAOD,KAIfA,KADAA,IAAM,0EADY1B,EAAE,gBAAgBQ,MAEV,KAC1BiB,QAAQE,OAAOD,KAIfA,KADAA,IAAM,oFADU1B,EAAE,cAAcQ,MAER,KACxBiB,QAAQE,OAAOD,KAIfA,KADAA,IAAM,kFADS1B,EAAE,aAAaQ,MAEP,KACvBiB,QAAQE,OAAOD,KAGfA,IAAM,2EADM1B,EAAE,iBAAiBQ,MAC4D,KAC3FiB,QAAQE,OAAOD,KAGfA,IAAM,6EADO1B,EAAE,kBAAkBQ,MAC6D,KAC9FiB,QAAQE,OAAOD,KAGfA,IAAM,yFADO1B,EAAE,kBAAkBQ,MACyE,KAC1GiB,QAAQE,OAAOD,KAEfA,IAAM,mFACND,QAAQE,OAAOD,KAEfA,IAAM,2FACND,QAAQE,OAAOD,KAEfA,IAAM,6FACND,QAAQE,OAAOD,KAInB1B,EAAE,uBAAwBG,OAAOC,UAAUI,IAAIO,UAE/Cf,EAAE,yBAA0BG,OAAOC,UAAUI,IAAIU,YAEjDlB,EAAE,sBAAuBG,OAAOC,UAAUI,IAAIY,UAE9CpB,EAAE,0BAA2BG,OAAOC,UAAUI,IAAIa,cAElDrB,EAAE,2BAA4BG,OAAOC,UAAUI,IAAIc,eAGnDtB,EAAE,wBAAyBG,OAAOC,UAAUO,KAAK,YAAY,GAC7DX,EAAE,wBAAyBG,OAAOC,UAAUQ,IAAI,CAACC,QAAS,QA0B1De,CAAoBd,MAGxBZ,mBAEAF,EAAE,wBAAyBG,OAAOC,UAAUO,KAAK,YAAY,GAC7DX,EAAE,wBAAyBG,OAAOC,UAAUQ,IAAI,CAACC,QAAS,SAGtE"}